{
  "hash": "83078cffdbad6ed2d86eff6befaaf5a7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Case 2\nsubtitle: 'Applied Multiple Regression/Correlation Analysis for the Behavioral Sciences by Jacob Cohen, Patricia Cohen, Stephen G. West, Leona S. Aiken'\ndate: last-modified\nauthor: Sungkyun Cho\nexecute:\n  warning: false\n  #freeze: auto\nformat: \n   html:\n    df-print: tibble\n   # monofont: 'FiraCode-Regular'\n---\n\n::: {.cell}\n\n:::\n\n\n\n\n## Guber (1999)의 SAT 점수와 주(states)의 교육지출 사이의 관계\n*Source: Statistical Methods for Psychology (8e) by Dave C. Howell*\n\n::: {layout-ncol=2}\n- 각 주에서 집행되는 교육지출이 미국 학생의 SAT 점수에 미치는 효과를 알아보고자 함.\n- SAT를 치르는 학생들의 비율이 주마다 상이함.\n- Data: [ACT.csv](https://www.dropbox.com/s/ezviy8cdz7039cn/ACT.csv?dl=1)\n\n![](images/SAT.png){width=400}\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nact <- read_csv(\"howell/ACT.csv\")\nact\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 50 × 12\n      id State   Expend PTratio Salary PctSAT Verbal  Math   SAT PctACT   ACT\n   <dbl> <chr>    <dbl>   <dbl>  <dbl>  <dbl>  <dbl> <dbl> <dbl>  <dbl> <dbl>\n 1     1 Alabama   4.40    17.2   31.1      8    491   538  1029     61  20.2\n 2     2 Alaska    8.96    17.6   48.0     47    445   489   934     32  21  \n 3     3 Arizona   4.78    19.3   32.2     27    448   496   944     27  21.1\n 4     4 Ark       4.46    17.1   28.9      6    482   523  1005     66  20.3\n 5     5 Calif     4.99    24     41.1     45    417   485   902     11  21  \n 6     6 Col       5.44    18.4   34.6     29    462   518   980     62  21.5\n 7     7 Conn      8.82    14.4   50.0     81    431   477   908      3  21.7\n 8     8 Del       7.03    16.6   39.1     68    429   468   897      3  21  \n 9     9 Florida   5.72    19.1   32.6     48    420   469   889     36  20.7\n10    10 Georgia   5.19    16.3   32.3     65    406   448   854     16  20.2\n# ℹ 40 more rows\n# ℹ 1 more variable: LogPctSAT <dbl>\n```\n\n\n:::\n:::\n\n\n\n*A. 변수들 간의 관계 탐색*\n\n\n\n::: {.cell layout=\"[50, 40, 10]\"}\n\n```{.r .cell-code}\nlowerCor(act[c(\"SAT\", \"Expend\", \"LogPctSAT\", \"Salary\")])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          SAT   Expnd LPSAT Salry\nSAT        1.00                  \nExpend    -0.38  1.00            \nLogPctSAT -0.93  0.56  1.00      \nSalary    -0.44  0.87  0.61  1.00\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(corrgram)\nact[c(\"SAT\", \"Expend\", \"LogPctSAT\", \"Salary\")] |> \n  corrgram(upper.panel = panel.cor, lower.panel = panel.pie)\n```\n\n::: {.cell-output-display}\n![](case2_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nGGally::ggpairs(act[c(\"SAT\", \"Expend\", \"LogPctSAT\", \"Salary\")])\n```\n\n::: {.cell-output-display}\n![](case2_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nact |> ggplot(aes(x = PctSAT, y = SAT)) + geom_point() + geom_smooth()\n```\n\n::: {.cell-output-display}\n![](case2_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nact |> ggplot(aes(x = LogPctSAT, y = SAT)) + geom_point() + geom_smooth()\n```\n\n::: {.cell-output-display}\n![](case2_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n\n\n*B1. 부분 회귀 계수들*\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1 <- lm(SAT ~ Expend, data = act)\nmod2 <- lm(SAT ~ Expend + LogPctSAT, data = act)\n```\n:::\n\n\n\n\n![](images/SAT2.png){width=400}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexport_summs(mod1, mod2, error_format = \"({p.value})\") |> print()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              ────────────────────────────────────────────────────\n                                    Model 1          Model 2      \n                               ───────────────────────────────────\n                (Intercept)         1089.29 ***      1147.10 ***  \n                                      (0.00)           (0.00)     \n                Expend               -20.89 **         11.13 **   \n                                      (0.01)           (0.00)     \n                LogPctSAT                             -78.20 ***  \n                                                       (0.00)     \n                               ───────────────────────────────────\n                N                     50               50         \n                R2                     0.14             0.89      \n              ────────────────────────────────────────────────────\n                *** p < 0.001; ** p < 0.01; * p < 0.05.           \n\nColumn names: names, Model 1, Model 2\n```\n\n\n:::\n\n```{.r .cell-code}\n# beta: standardized coefficients\nlm.beta::lm.beta(mod2) |> print()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = SAT ~ Expend + LogPctSAT, data = act)\n\nStandardized Coefficients::\n(Intercept)      Expend   LogPctSAT \n         NA    0.202704   -1.039937 \n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](case2_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n*B2. 부분 회귀 계수들*\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1 <- lm(SAT ~ LogPctSAT, data = act)\nmod2 <- lm(SAT ~ LogPctSAT + Expend, data = act)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nexport_summs(mod1, mod2, error_format = \"({p.value})\") |> print()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              ────────────────────────────────────────────────────\n                                    Model 1          Model 2      \n                               ───────────────────────────────────\n                (Intercept)         1185.83 ***      1147.10 ***  \n                                      (0.00)           (0.00)     \n                LogPctSAT            -69.65 ***       -78.20 ***  \n                                      (0.00)           (0.00)     \n                Expend                                 11.13 **   \n                                                       (0.00)     \n                               ───────────────────────────────────\n                N                     50               50         \n                R2                     0.86             0.89      \n              ────────────────────────────────────────────────────\n                *** p < 0.001; ** p < 0.01; * p < 0.05.           \n\nColumn names: names, Model 1, Model 2\n```\n\n\n:::\n:::\n\n\n\n\n*C. 부분 상관 계수들*\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlowerCor(act[c(\"SAT\", \"Expend\", \"LogPctSAT\")])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          SAT   Expnd LPSAT\nSAT        1.00            \nExpend    -0.38  1.00      \nLogPctSAT -0.93  0.56  1.00\n```\n\n\n:::\n\n```{.r .cell-code}\nsumm(mod2, part.corr = TRUE, model.info = FALSE, model.fit = FALSE) |> print()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStandard errors:OLS\n------------------------------------------------------------------------\n                       Est.    S.E.   t val.      p   partial.r   part.r\n----------------- --------- ------- -------- ------ ----------- --------\n(Intercept)         1147.10   16.70    68.68   0.00                     \nLogPctSAT            -78.20    4.47   -17.49   0.00       -0.93    -0.86\nExpend                11.13    3.26     3.41   0.00        0.45     0.17\n------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\n**Summary**\n\n::: {layout=\"[50, -2, 48]\"}\n|  | $r$ | $\\beta$ | $pr$ | $sr$ |\n|:--------:|:---:|:---:|:---:|:---:|\n| Expend     | -0.38| 0.20| 0.45| 0.17|\n| LogPctSAT  | -0.93| -1.04| -0.93| -0.86|\n\n|  | $r^2$ | $\\beta^2$ | $pr^2$ | $sr^2$ |\n|:--------:|:---:|:---:|:---:|:---:|\n| Expend     | 0.14| 0.04| 0.20| 0.03|\n| LogPctSAT  | 0.86| 1.08| 0.86| 0.74|\n:::\n\n*D. 예측변수의 추가*  \n예측변수가 3개인 경우\n\n![](images/SAT.png){width=400}\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nmod3 <- lm(SAT ~ Salary, data = act)\nmod4 <- lm(SAT ~ Salary + Expend, data = act)\nmod5 <- lm(SAT ~ Salary + Expend + LogPctSAT, data = act)\n\nexport_summs(mod0, mod2, mod3, mod4, mod5, model.names = c(\"mod0\", \"mod2\", \"mod3\", \"mod4\", \"mod5\")) |> print()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n───────────────────────────────────────────────────────────────────────────────\n                  mod0         mod2         mod3         mod4         mod5     \n             ──────────────────────────────────────────────────────────────────\n  (Intercept      1089.29      1147.10      1158.86      1159.35      1133.11  \n  )                   ***          ***          ***          ***          ***  \n               (44.39)      (16.70)      (57.66)      (60.22)      (22.73)     \n  Expend       -20.89 **     11.13 **                   0.47         7.10      \n                (7.33)       (3.26)                   (14.58)       (5.50)     \n  LogPctSAT                 -78.20 ***                             -79.51 ***  \n                             (4.47)                                 (4.71)     \n  Salary                                  -5.54 **     -5.63         1.20      \n                                          (1.63)       (3.34)       (1.32)     \n             ──────────────────────────────────────────────────────────────────\n  N             50           50           50           50           50         \n  R2             0.14         0.89         0.19         0.19         0.89      \n───────────────────────────────────────────────────────────────────────────────\n  *** p < 0.001; ** p < 0.01; * p < 0.05.                                      \n\nColumn names: names, mod0, mod2, mod3, mod4, mod5\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# marginal vs. added-variable plots\nmcPlots(mod4, overlaid = FALSE) # library(car)\n```\n\n::: {.cell-output-display}\n![](case2_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# added-variable plots\navPlots(mod5) # library(car)\n```\n\n::: {.cell-output-display}\n![](case2_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n:::\n\n\n\n\nQ: `Salary`와 `Expend` 중 하나는 제거해야 되나???\n\n- 상관관계가 높은 변수들은 서로 partial out되어 남은 잔차들의 변량이 줄어 Y와의 관계를 온전히 테스트하기 어려워짐\n- 구체적으로는 standard error를 높여서 회귀계수에 대한 모집단에 대한 신뢰도를 낮춤\n- 이를 다중공선성(multicollinearity)이라고 함\n  - variance inflation factor (VIF)로 측정함\n  - 표준오차를 $\\sqrt{vif}$배 만큼 증가시킨다고 해석\n- 이들을 하나의 \"묶음\"(set)으로 취급해도 무방함\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvif(mod5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Salary    Expend LogPctSAT \n 4.531896  4.128730  1.609542 \n```\n\n\n:::\n:::",
    "supporting": [
      "case2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}