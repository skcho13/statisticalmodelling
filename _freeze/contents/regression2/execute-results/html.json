{
  "hash": "282fdfe6f1daf7abbe78e7f0048abe94",
  "result": {
    "markdown": "---\ntitle: Multiple Regression\nsubtitle: 'Applied Multiple Regression/Correlation Analysis for the Behavioral Sciences by Jacob Cohen, Patricia Cohen, Stephen G. West, Leona S. Aiken'\ndate: 'Feb 17, 2023'\nauthor: Sungkyun Cho\nexecute:\n  warning: false\n  freeze: auto\nformat: \n   html:\n    df-print: tibble\n---\n\n::: {.cell}\n\n:::\n\n\n# Multiple linear/regression models\n\n- 독립/예측 변수가 1개 이상인 경우\n- 예측변수들 각각의 **고유한 효과**(effect)를 추정(estimate)\n- 이는 다른 변수들의 값이 **고정된다면(holding it constant)** 해당 변수의 효과는 어떠한가를 의미\n\n\n## Case 1\n\n![](images/diagram2.png)\n\n교수의 연봉(`salary`)이 학위를 받은 후 지난 시간(`time` since Ph.D.)과 출판물의 수(`pubs`)에 의해 어떻게 영향을 받는가?\n\n- 같은 연차의 교수들 간에 논문 수에 따라 연봉은 얼마나 차이가 나는가?\n- 동일한 개수의 논문을 발표한 교수들 간에 연차에 따라 연봉은 얼마나 차이가 나는가?\n\n앞서 연봉에 대한 예측모형을 다음과 같이 얻었는데,\n\n- Model 1:   $\\widehat{salary} = \\$1,224\\:time + \\$43,659$\n- Model 2 :   $\\widehat{salary} = \\$336\\:pubs + \\$46,357$\n\n다음과 같이 연차가 늘면 논문의 수도 따라서 늘어나는 경향이 있기 때문에, 연차 또는 논문 수의 고유한 효과를 추정하기 어려움.\n\n- $\\widehat{pubs} = 1.98\\:time + 4.73$\n- $\\widehat{time} = 0.22\\:pubs + 3.33$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacad0 <- read_csv(\"data/c0301dt.csv\")\nacad0 \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 15 × 3\n    time  pubs salary\n   <dbl> <dbl>  <dbl>\n 1     3    18  51876\n 2     6     3  54511\n 3     3     2  53425\n 4     8    17  61863\n 5     9    11  52926\n 6     6     6  47034\n 7    16    38  66432\n 8    10    48  61100\n 9     2     9  41934\n10     5    22  47454\n11     5    30  49832\n12     6    21  47047\n13     7    10  39115\n14    11    27  59677\n15    18    37  61458\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1 <- lm(salary ~ time, data = acad0)\nmod2 <- lm(salary ~ pubs, data = acad0)\n\nmod3 <- lm(salary ~ time + pubs, data = acad0)\ncoef(mod3) |> round(2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept)        time        pubs \n   43082.39      982.87      121.80 \n```\n:::\n:::\n\n\n### 두 개의 예측변수를 모두 포함한 모형 \nModel 3:   $\\widehat{Y} = a_1 X_1 + a_2 X_2 + a_0 ~ (z=2x-y+1)$\n\n$\\widehat{salary} = \\$983\\:time + \\$122\\:pubs + \\$43,082$\n\nThe regression plane:  \n![](images/regression_plane.png){width=400}\n\n::: {.callout-note collapse=\"true\"}\n### 3d plot\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-7478eaf8ede5c41b8c97\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7478eaf8ede5c41b8c97\">{\"x\":{\"visdat\":{\"3a43239bd613\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"3a43239bd613\",\"attrs\":{\"3a43239bd613\":{\"x\":{},\"y\":{},\"z\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\",\"mode\":\"markers\",\"marker\":{\"color\":[51876,54511,53425,61863,52926,47034,66432,61100,41934,47454,49832,47047,39115,59677,61458],\"colorscale\":[\"#FFE1A1\",\"#FF4304\"],\"size\":6},\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"scene\":{\"xaxis\":{\"title\":\"pubs\"},\"yaxis\":{\"title\":\"time\"},\"zaxis\":{\"title\":\"salary\"}},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[18,3,2,17,11,6,38,48,9,22,30,21,10,27,37],\"y\":[3,6,3,8,9,6,16,10,2,5,5,6,7,11,18],\"z\":[51876,54511,53425,61863,52926,47034,66432,61100,41934,47454,49832,47047,39115,59677,61458],\"type\":\"scatter3d\",\"mode\":\"markers\",\"marker\":{\"color\":[51876,54511,53425,61863,52926,47034,66432,61100,41934,47454,49832,47047,39115,59677,61458],\"colorscale\":[\"#FFE1A1\",\"#FF4304\"],\"size\":6,\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"line\":{\"color\":\"rgba(31,119,180,1)\"},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n:::\n\n- 교수들의 연차와 그들이 쓴 논문 수는 깊이 연관되어 있으며 (*r* = 0.66), 두 변수의 redunancy가 각 변수들의 효과를 변화시킴.\n- 두 예측 변수의 산술적 합으로 연봉을 예측하므로 각 예측변수의 효과는 수정될 수 밖에 없음.\n- 수학적으로 보면, 각 예측변수의 기울기는 다른 예측변수의 값에 상관없이 일정하므로, 다른 예측변수들을 (임의의 값에) **고정시키는 효과**를 가짐\n- 즉, 다른 변수와는 독립적인, **고유한 효과**를 추정하게 됨\n\n세 모형을 비교하면,\n\nModel 1:   $\\widehat{salary} = \\$1,224\\:time + \\$43,659$  \nModel 2 :   $\\widehat{salary} = \\$336\\:pubs + \\$46,357$  \nModel 3:   $\\widehat{salary} = \\$983\\:time + \\$122\\:pubs + \\$43,082$\n\n- 연차(time)의 효과는 $1,224에서 $984로 낮아졌고,\n- 논문수(pubs)의 효과는 $336에서 $122로 낮아졌음\n\n각각의 효과가 줄어든 것은 연차와 논문수 정보의 redundancy로부터 발생한 것임. \n\n다른 변수가 **partial out** 된 후의 효과. 실제로 연차로 예측되지 않는 논문수(residuals)로 연봉을 예측할 때의 기울기\n\n해석은, 만약 논문 수가 일정할 때, 예를 들어 10편의 논문을 쓴 경우만 봤을 때, 연차가 1년 늘 때마다 연봉은 $984 증가함\n\n또는 만약, 연차가 일정할 때, 예를 들어 연차가 12년차인 경우만 봤을 때, 논문이 1편 늘 때마다 연봉은 $336 증가함\n\n이는 다른 **변수를 고려(통제, controlling for)했을 때 혹은 다른 변수의 효과를 제거(partial out)했을 때**, 각 변수의 **고유한 효과**를 의미함 (*holding constant* or *controlling for, partialing the effects of,* or *residualizing)* \n\n뒤집어 말하면, 연차만 고려했을때 연차가 1년 늘면 $1,224 연봉이 증가하는 효과는 연차가 늘때 함께 늘어나는 논문 수의 효과가 함께 섞여 나온 효과라고 말할 수 있음.\n\n이는 인과관계에 있는 변수들의 진정한 효과를 찾는 것이 얼마나 어려운지를 보여줌\n\n![](images/partials.png){width=800}",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<script src=\"../site_libs/plotly-binding-4.10.1/plotly.js\"></script>\n<script src=\"../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n<link href=\"../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}