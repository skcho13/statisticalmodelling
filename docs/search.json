[
  {
    "objectID": "contents/interaction.html#continuous-vs.-continuous",
    "href": "contents/interaction.html#continuous-vs.-continuous",
    "title": "Interaction Effects",
    "section": "Continuous vs. Continuous",
    "text": "Continuous vs. Continuous\n\n예제 1\n나이가 듦(age)에 따른 지구력(endurance)의 감소가 운동을 한 기간(exercise)에 따라 변화하는가? (p.275)\nData: c07e01dt\nendurance: the number of minutes of sustained jogging on a treadmill\nexercise: the number of years of vigorous physical exercise\n\n\n연구자의 관심변수에 따라 다르게 표현될 수 있음.\n나이가 지구력에 미치는 부정적 영향을 운동이 완화시키는지 관심.\n이 때, 운동이 moderator로 작용하는 moderating effect (조절효과)를 가지는지 검증.\n통계적으로는 나이과 운동기간이 서로 상호작용(interact)하여 지구력에 영향을 미치는 것으로 나타남.\n\n\n\n\nacad2 <- read_csv('cohen/data/c07e01dt.csv')\nacad2\n\n# A tibble: 245 × 3\n     age exercise endurance\n   <dbl>    <dbl>     <dbl>\n 1    60       10        18\n 2    40        9        36\n 3    29        2        51\n 4    47       10        18\n 5    48        9        23\n 6    42        6        30\n 7    55        8         8\n 8    43       19        40\n 9    39        9        28\n10    51       14        15\n# ℹ 235 more rows\n\n\n\nlibrary(psych)\nlowerCor(acad2)\n\n          age   exrcs endrn\nage        1.00            \nexercise   0.28  1.00      \nendurance -0.13  0.34  1.00\n\n\n\n\n\n\n\nacad2 %>% \n  ggplot(aes(x = age, y = endurance)) +\n  geom_point() +\n  geom_smooth(se = FALSE, span = 1)\n\n\n\n\n\nacad2 %>% \n  ggplot(aes(x = exercise, y = endurance)) +\n  geom_point() +\n  geom_smooth(se = FALSE, span = 1)\n\n\n\n\n\n\n나이와 지구력의 관계가 운동기간에 따라 다른가를 보기 위해, 운동기간을 3구간으로 나눔.\n\n# 편의상 운동기간을 3구간으로 나눔\nacad2 %>% \n  mutate(exercise_cat = cut_number(exercise, 3)) %>% \n  ggplot(aes(x = age, y = endurance, color = exercise_cat)) +\n  geom_point() +\n  geom_smooth(se = FALSE, span = 1) +\n  facet_wrap(~exercise_cat)\n\n\n\n# 편의상 나이를 3구간으로 나눔\nacad2 %>% \n  mutate(age_cat = cut_number(age, 3)) %>% \n  ggplot(aes(x = exercise, y = endurance, color = age_cat)) +\n  geom_point() +\n  geom_smooth(se = FALSE, span = 1) +\n  facet_wrap(~age_cat)\n\n\n\n\n두 변수, 나이와 운동기간으로 지구력을 예측하는 모형을 세우면,\n\nmod_s1 <- lm(endurance ~ age, data = acad2)\nmod_s2 <- lm(endurance ~ exercise, data = acad2)\nmod <- lm(endurance ~ age + exercise, data = acad2)\nexport_summs(mod_s1, mod_s2, mod)\n\n\n\n\nModel 1Model 2Model 3\n\n(Intercept)33.16 ***18.39 ***29.40 ***\n\n(3.42)   (1.60)   (3.21)   \n\nage-0.13 *         -0.26 ***\n\n(0.07)          (0.07)   \n\nexercise       0.76 ***0.92 ***\n\n       (0.14)   (0.14)   \n\nN245       245       245       \n\nR20.02    0.11    0.17    \n\n *** p < 0.001;  ** p < 0.01;  * p < 0.05.\n\n\n\n\nInteraction term을 추가해서 모형을 세우면\n\\(\\displaystyle \\widehat{endurance} = b_1\\cdot age + b_2\\cdot exercise + b_3\\cdot age \\cdot exercise + b_0\\)\n      \\(\\displaystyle = (b_1 + b_3 \\cdot exercise)\\cdot age + b_2\\cdot exercise + b_0\\)\n이제 age의 기울기가 exercise의 값에 따라 변할 수 있음.\n\n\n\n\n\n\n\n\n\n\n\nmod_interact <- lm(endurance ~ age * exercise, data = acad2)  \n# 동일: endurance ~ age + exercise + age:exercise\nS(mod_interact) # library(car)\n\nCall: lm(formula = endurance ~ age * exercise, data = acad2)\n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  53.17896    7.52661   7.065 1.71e-11 ***\nage          -0.76596    0.15980  -4.793 2.87e-06 ***\nexercise     -1.35095    0.66626  -2.028 0.043694 *  \nage:exercise  0.04724    0.01359   3.476 0.000604 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard deviation: 9.7 on 241 degrees of freedom\nMultiple R-squared: 0.2061\nF-statistic: 20.86 on 3 and 241 DF,  p-value: 4.764e-12 \n    AIC     BIC \n1814.57 1832.07 \n\n\n\\(\\displaystyle \\widehat{endurance} = -0.766\\cdot age -1.350\\cdot exercise + 0.047\\cdot age \\cdot exercise + 53.18\\)\n      \\(\\displaystyle = (-0.766 + 0.047 \\cdot exercise)\\cdot age -1.350\\cdot exercise + 53.18\\)\n\nage의 기울기는 exercise의 값에 따라 변함\n운동기간이 0년인 경우, 지구력에 미치는 나이의 효과: \\((-0.766+0.047*0)\\cdot age = -0.766\\cdot age\\)\n운동기간이 10년인 경우, 지구력에 미치는 나이의 효과: \\((-0.766+0.047*10)\\cdot age = -0.30\\cdot age\\)\n\n각 회귀계수의 의미는 다른 변수의 값이 0일 때의 기울기/효과임\n\nage: -0.766은 운동기간이 0년일 때의 나이의 효과\nexercise: -1.350은 나이가 0살일 때의 운동기간의 효과\nage:exercise: 0.047는 두 변수의 joint effect\n절편 53.18: 운동기간이 0년인 0세의 지구력\n\n회귀계수를 용이하게 해석하기 위해 변수를 centering하거나 standardizing하는 것이 좋음.\n\n0의 의미가 있는 특별한 경우가 아니면 centering을 기본적으로 함.\n예를 들어, 언어발달 ~ 나이 * 형제자매 수 + 부모의 교육수준\n\n형제자매의 수 0은 의미가 있음.\n\n위의 경우 age와 exercise의 단위가 의미가 있으므로, 표준화보다는 centering\np-value들은 모두 바뀐 의미의 회귀계수에 대한 영가설 검정\n\n\n# jtools의 center()함수를 이용하거나 데이터셋에서 미리 변환\nmod_interact_c <- lm(endurance ~ center(age) * center(exercise), data = acad2)\nS(mod_interact_c)\n\nCall: lm(formula = endurance ~ center(age) * center(exercise), data = acad2)\n\nCoefficients:\n                             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                  25.88872    0.64662  40.037  < 2e-16 ***\ncenter(age)                  -0.26169    0.06406  -4.085 6.01e-05 ***\ncenter(exercise)              0.97272    0.13653   7.124 1.20e-11 ***\ncenter(age):center(exercise)  0.04724    0.01359   3.476 0.000604 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard deviation: 9.7 on 241 degrees of freedom\nMultiple R-squared: 0.2061\nF-statistic: 20.86 on 3 and 241 DF,  p-value: 4.764e-12 \n    AIC     BIC \n1814.57 1832.07 \n\n\n\n나이에 대한 회귀계수 -0.26: 운동기간이 평균(10.67년)일 때의 나이의 효과\n운동기간에 대한 회귀계수 0.97: 나이가 평균(49.18세)일 때의 운동기간의 효과\n\n\npsych::describe(acad2)\n\n          vars   n  mean    sd median trimmed   mad min max range skew kurtosis\nage          1 245 49.18 10.11     48   49.11 10.38  20  82    62 0.15    -0.08\nexercise     2 245 10.67  4.78     11   10.56  4.45   0  26    26 0.27     0.23\nendurance    3 245 26.53 10.82     27   26.39 10.38   0  55    55 0.11    -0.30\n            se\nage       0.65\nexercise  0.31\nendurance 0.69\n\n\n\nlibrary(effects)\nplot(predictorEffects(mod_interact, ~age, xlevels = 3))  # centering하지 않은 모형\n\n\n\nplot(predictorEffect(\"age\", mod_interact, xlevels = 3))  # centering하지 않은 모형\n\n\n\nm <- mean(acad2$exercise, na.rm = TRUE) |> round(2)\nsd <- sd(acad2$exercise, na.rm = TRUE) |> round(2)\n\nplot(predictorEffects(mod_interact, ~age, xlevels = list(exercise = c(m-sd, m, m+sd))))\n\n\n\n\n평균보다 1 표준편차 만큼 오래 운동한 경우: m + 1sd = 10.67 + 4.78 = 15.45년\n\n나이에 따른 지구력 감소가 거의 없는가?\n\n\nmod_interact_t <- lm(endurance ~ age * I(exercise - 15.45), data = acad2)\nS(mod_interact_t)  # car\n\nCall: lm(formula = endurance ~ age * I(exercise - 15.45), data = acad2)\n\nCoefficients:\n                        Estimate Std. Error t value Pr(>|t|)    \n(Intercept)             32.30671    4.72744   6.834 6.71e-11 ***\nage                     -0.03602    0.09027  -0.399 0.690184    \nI(exercise - 15.45)     -1.35095    0.66626  -2.028 0.043694 *  \nage:I(exercise - 15.45)  0.04724    0.01359   3.476 0.000604 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard deviation: 9.7 on 241 degrees of freedom\nMultiple R-squared: 0.2061\nF-statistic: 20.86 on 3 and 241 DF,  p-value: 4.764e-12 \n    AIC     BIC \n1814.57 1832.07 \n\nConfint(mod_interact_t) |> print(digits = 2)  # car\n\n                        Estimate 2.5 % 97.5 %\n(Intercept)               32.307 22.99 41.619\nage                       -0.036 -0.21  0.142\nI(exercise - 15.45)       -1.351 -2.66 -0.039\nage:I(exercise - 15.45)    0.047  0.02  0.074\n\n\n\n\n\n\n\n\nInteraction의 패턴\n\n\n\n\nSynergistic or enhancing interaction\n\n\n상호작용 효과가 원래 효과들과 같은 방향으로 작용하는 경우\n삶의 만족도(Y)가 직업 스트레스(X)와 부정적인 관계에 있고, 부부관계의 문제(Z)와도 부정적인 관계에 있는 경우\n이 둘의 상호작용이 부정적이라면, 직업 스트레스와 부부관계의 문제가 동시에 증가하면 각각의 sum이 예측하는 것보다 더 낮은 삶의 만족도가 예측됨.\n\n\nBuffering interaction\n\n\n두 변수가 반대 방향으로 Y에 작용하고 있을 때, 한 변수가 다른 변수의 효과를 감소시키는 경우\n즉, 한 변수의 impact가 다른 변수의 impact를 줄여주는 경우\n건강보건에 대한 연구에서, 한 변수가 질병의 위험요인이고 다른 변수가 질병의 위험을 줄여주는 보호요인인 경우\n위의 예에서처럼, 나이(X)는 지구력 감소의 위험요인이고, 운동기간(Z)은 지구력 보호요인인 경우\n\n\nInterference or antagonistic interactionin\n\n\n두 변수가 같은 방향으로 Y에 작용하고 있을 때, 상호작용은 반대 방향으로 작용하는 경우\n대학생의 학업성취도(Y)에 대하여, 학업동기(X)와 학업능력(Z)이 모두 학업성취도(Y)에 긍정적인 영향을 미치나 이 두 변수는 서로 보완적인 효과를 가지고 있음.\n즉, 성취도에 대한 학업능력의 중요성은 높은 학업동기에 의해 낮아질 수 있음.\n반대로, 학업동기에 대한 중요성은 높은 학업능력에 의해 낮아질 수 있음.\n\n\n\n\n\n예제 2\nSource: p.551, Statistical Methods for Psychology (8e) by Dave C. Howell\n오리엔테이션에 참석한 대학 신입생을 대상으로, 스트레스 받은 일(hassles)이 많을 수록 여러 증상들(symptoms)을 더 경험하는데, 주위의 지지(support)가 많을 수록 그 증상들이 감소한다는 것을 알아보고자 설문 조사. (Wagner, Compas, and Howell (1988))\n\nhassles: 소소한 일상적인 스트레스를 경험한 횟수\nsupport: 본인이 인지하는 주위의 지지 정도\nsymptoms: 증상에 대한 checklist로 나타난 증상의 개수\n\nData: hassles.csv\n\n\nhassles <- read_csv(\"data/hassles.csv\")\nhassles\n\n# A tibble: 56 × 3\n   hassles support symptoms\n     <dbl>   <dbl>    <dbl>\n 1     176      10       73\n 2     379      50       88\n 3     126      45      118\n 4     193      40       79\n 5     229      40      127\n 6     153      39       73\n 7     214      38       93\n 8     164      37       99\n 9     143      36       81\n10      27      36       64\n# ℹ 46 more rows\n\ncar::scatterplotMatrix(hassles)\n\n\n\nhassles |> \n  lowerCor()  # library(psych)\n\n         hssls spprt sympt\nhassles   1.00            \nsupport  -0.17  1.00      \nsymptoms  0.58 -0.13  1.00\n\nhassles <- hassles |> \n  mutate(\n    hassles_c = center(hassles),  # library(jtools)\n    support_c = center(support),\n    symptom_c = center(symptoms),\n  )\n\nmod <- lm(symptom_c~ hassles_c * support_c, data = hassles)\nS(mod)  # library(car)\n\nCall: lm(formula = symptom_c ~ hassles_c * support_c, data = hassles)\n\nCoefficients:\n                     Estimate Std. Error t value Pr(>|t|)    \n(Intercept)         -0.843632   2.291503  -0.368   0.7143    \nhassles_c            0.085942   0.019213   4.473 4.22e-05 ***\nsupport_c            0.146358   0.305244   0.479   0.6336    \nhassles_c:support_c -0.005065   0.002363  -2.144   0.0368 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard deviation: 16.89 on 52 degrees of freedom\nMultiple R-squared: 0.3885\nF-statistic: 11.01 on 3 and 52 DF,  p-value: 1.046e-05 \n   AIC    BIC \n481.39 491.51 \n\n\n\nhassles |> ggplot(aes(x = support_c)) + geom_freqpoly()\n\n\n\n\n\nlibrary(effects)\n# 임의의 3 levels 선택\npredictorEffects(mod, xlevels = 3) |>  # 임의의 3 levels 선택\n  plot(lines = list(multiline = TRUE)) # 3개의 선을 함께 그림\n\n\n\n\n\n# 특정 3 levels 선택: -10(평균-10), 0(평균), 10(평균+10)\npredictorEffects(mod, ~ hassles_c, \n                 xlevels = list(support_c = c(-10, 0, 10))) |>  # 특정 3 levels 선택\n  plot(lines = list(multiline = TRUE))  # 3개의 선을 함께 그림\n\n\n\n\nsupport_c가 10일 때, hassels의 기울기는 통계적으로 유의한가를 테스트\n\nmod_probe <- lm(symptom_c ~ hassles_c * I(support_c - 10), data = hassles)\nS(mod_probe)  # library(car)\n\nCall: lm(formula = symptom_c ~ hassles_c * I(support_c - 10), data = hassles)\n\nCoefficients:\n                             Estimate Std. Error t value Pr(>|t|)  \n(Intercept)                  0.619943   3.697199   0.168   0.8675  \nhassles_c                    0.035293   0.034034   1.037   0.3045  \nI(support_c - 10)            0.146358   0.305244   0.479   0.6336  \nhassles_c:I(support_c - 10) -0.005065   0.002363  -2.144   0.0368 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard deviation: 16.89 on 52 degrees of freedom\nMultiple R-squared: 0.3885\nF-statistic: 11.01 on 3 and 52 DF,  p-value: 1.046e-05 \n   AIC    BIC \n481.39 491.51 \n\n\n모든 moderator의 값에 대한 통계적 유의도를 계산\n\n# Johnson-Neyman intervals \nlibrary(interactions)\njohnson_neyman(mod, pred = \"hassles_c\", modx = \"support_c\")\n\nJOHNSON-NEYMAN INTERVAL \n\nWhen support_c is OUTSIDE the interval [6.25, 297.50], the slope of\nhassles_c is p < .05.\n\nNote: The range of observed values of support_c is [-18.96, 21.04]\n\n\n\n\n\n회귀모형에 대한 진단\n\navPlots(mod)\n\n\n\ninfluenceIndexPlot(mod)\n\n\n\nmod_update <- update(mod, subset = -52) # 52번째 관측치 제거\navPlots(mod_update)\n\n\n\nS(mod_update)\n\nCall: lm(formula = symptom_c ~ hassles_c * support_c, data = hassles, subset =\n         -52)\n\nCoefficients:\n                     Estimate Std. Error t value Pr(>|t|)    \n(Intercept)         -1.288549   2.156778  -0.597 0.552856    \nhassles_c            0.070908   0.018801   3.772 0.000423 ***\nsupport_c            0.125998   0.286624   0.440 0.662089    \nhassles_c:support_c -0.001655   0.002524  -0.656 0.515015    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard deviation: 15.86 on 51 degrees of freedom\nMultiple R-squared: 0.2291\nF-statistic: 5.053 on 3 and 51 DF,  p-value: 0.00385 \n   AIC    BIC \n465.93 475.97"
  },
  {
    "objectID": "contents/interaction.html#continuous-vs.-categorical",
    "href": "contents/interaction.html#continuous-vs.-categorical",
    "title": "Interaction Effects",
    "section": "Continuous vs. Categorical",
    "text": "Continuous vs. Categorical\n\n성별 이나 실험조건/통제조건 같이 두 개의 범주를 가지는 변수와의 상호작용\n직업군과 같이 세 개 이상의 범주를 가지는 변수와의 상호작용\n\n\nBinary 변수와의 상호작용\n예제 1: Data from the 1985 Current Population Survey (CPS85)\n교육수준(educ)에 따른 임금(wage)의 증가량이 직업군에 따라 다른가?\n\ncps <- mosaicData::CPS85 |> as_tibble()\ncps\n\n# A tibble: 534 × 11\n    wage  educ race  sex   hispanic south married exper union   age sector  \n   <dbl> <int> <fct> <fct> <fct>    <fct> <fct>   <int> <fct> <int> <fct>   \n 1  9       10 W     M     NH       NS    Married    27 Not      43 const   \n 2  5.5     12 W     M     NH       NS    Married    20 Not      38 sales   \n 3  3.8     12 W     F     NH       NS    Single      4 Not      22 sales   \n 4 10.5     12 W     F     NH       NS    Married    29 Not      47 clerical\n 5 15       12 W     M     NH       NS    Married    40 Union    58 const   \n 6  9       16 W     F     NH       NS    Married    27 Not      49 clerical\n 7  9.57    12 W     F     NH       NS    Married     5 Union    23 service \n 8 15       14 W     M     NH       NS    Single     22 Not      42 sales   \n 9 11        8 W     M     NH       NS    Married    42 Not      56 manuf   \n10  5       12 W     F     NH       NS    Married    14 Not      32 sales   \n# ℹ 524 more rows\n\n\n편의상 management와 professonal을 prof로 합치고, 나머지 sector들은 others로 합침\n\ncps <- cps |> \n  mutate(sector2 = ifelse(sector %in% c(\"manag\", \"prof\"), \"prof\", \"others\")) |> \n  filter(educ > 8 & wage < 30)\n\n\ncps |> ggplot(aes(x = educ, y = wage, color = sector2)) + geom_point() + geom_smooth(method=lm)\n\n\n\n\n\nmod <- lm(wage ~ educ * sector2, data = cps)\nS(mod)\n\nCall: lm(formula = wage ~ educ * sector2, data = cps)\n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)   \n(Intercept)        4.8011     1.8351   2.616  0.00916 **\neduc               0.2400     0.1461   1.642  0.10115   \nsector2prof       -6.9405     3.1148  -2.228  0.02631 * \neduc:sector2prof   0.6855     0.2190   3.130  0.00185 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard deviation: 4.413 on 502 degrees of freedom\nMultiple R-squared: 0.2111\nF-statistic: 44.79 on 3 and 502 DF,  p-value: < 2.2e-16 \n    AIC     BIC \n2944.32 2965.46 \n\npredictorEffects(mod) |> plot()\n\n\n\n\n예제 2: 상대방의 사회적 지위에 따른 이타성의 차이\n\n실험조건: 수혜자의 사회적 지위가 high status vs. low status\n통제변수: 돕는 사람의 공감능력\n\n\nhelping <- read_csv(\"data/altru.csv\")\nhelping\n\n# A tibble: 170 × 3\n   helping empathy status\n     <dbl>   <dbl> <chr> \n 1   45.5     58.1 low   \n 2   73.4     43.9 high  \n 3   73.6     76.8 high  \n 4    5.43    42.6 low   \n 5   29.5     80.6 high  \n 6   24.2     44.2 low   \n 7   68.6     77.6 low   \n 8   46.5     94.2 low   \n 9    3.76    87.3 high  \n10   36.0     57.9 high  \n# ℹ 160 more rows\n\n\n\nmod <- lm(helping ~ empathy * status, data = helping)\nS(mod)\n\nCall: lm(formula = helping ~ empathy * status, data = helping)\n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)   \n(Intercept)         8.6270    11.2547   0.767  0.44445   \nempathy             0.5022     0.1568   3.203  0.00163 **\nstatuslow         -29.6046    15.8479  -1.868  0.06352 . \nempathy:statuslow   0.5187     0.2161   2.401  0.01748 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard deviation: 21.97 on 166 degrees of freedom\nMultiple R-squared: 0.2845\nF-statistic:    22 on 3 and 166 DF,  p-value: 4.787e-12 \n    AIC     BIC \n1538.84 1554.52 \n\nmod_std <- lm(scale(helping) ~ scale(empathy) * status, data = helping)\nS(mod_std)\n\nCall: lm(formula = scale(helping) ~ scale(empathy) * status, data = helping)\n\nCoefficients:\n                         Estimate Std. Error t value Pr(>|t|)   \n(Intercept)              -0.15510    0.09089  -1.706  0.08979 . \nscale(empathy)            0.30706    0.09585   3.203  0.00163 **\nstatuslow                 0.29387    0.13167   2.232  0.02696 * \nscale(empathy):statuslow  0.31710    0.13209   2.401  0.01748 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard deviation: 0.8535 on 166 degrees of freedom\nMultiple R-squared: 0.2845\nF-statistic:    22 on 3 and 166 DF,  p-value: 4.787e-12 \n   AIC    BIC \n434.53 450.20 \n\ndescribe(helping)\n\n        vars   n  mean    sd median trimmed   mad   min max  range  skew\nhelping    1 170 48.61 25.74  48.25   48.82 27.47  0.00 100 100.00 -0.03\nempathy    2 170 71.66 15.74  73.94   72.38 17.65 13.08 100  86.92 -0.45\nstatus*    3 170  1.48  0.50   1.00    1.47  0.00  1.00   2   1.00  0.09\n        kurtosis   se\nhelping    -0.73 1.97\nempathy    -0.05 1.21\nstatus*    -2.00 0.04\n\nplot(predictorEffects(mod, ~status, xlevels = list(empathy = c(71.6-15.7, 71.6, 1+15.7))))\n\n\n\n\n\n\n3개 이상의 범주를 가지는 변수와의 상호작용\nData: c0904dt2.csv\n\nacad3 <- read_csv(\"data/c0904dt2.csv\")\nacad3\n\n# A tibble: 150 × 5\n   depart    pub  time salary sex   \n   <chr>   <dbl> <dbl>  <dbl> <chr> \n 1 anthrop    16     3 56465. female\n 2 anthrop    25     7 92044. male  \n 3 anthrop    16     2 48980. female\n 4 anthrop    24     1 53239. female\n 5 anthrop    24     8 98948. male  \n 6 anthrop    26    14 64782. male  \n 7 anthrop    39     5 91652. male  \n 8 anthrop    16     1 32833. male  \n 9 anthrop    26    10 79231. male  \n10 anthrop    23    11 77154. female\n# ℹ 140 more rows\n\n\n\nacad3 <- acad3 |> mutate(pub_c = center(pub), time_c = center(time))\nacad3 |> \n  ggplot(aes(x = pub, y = salary, color = depart)) +\n  geom_point() + geom_smooth(method=lm) + facet_wrap(~depart)\n\n\n\n\n\nmod <- lm(salary ~ pub_c * depart, data = acad3)\nS(mod)\n\nCall: lm(formula = salary ~ pub_c * depart, data = acad3)\n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       56917.9     2207.4  25.785  < 2e-16 ***\npub_c              1372.9      252.5   5.438 2.25e-07 ***\ndeparthist         9796.1     3615.1   2.710  0.00755 ** \ndepartsoc          9672.8     3235.2   2.990  0.00328 ** \npub_c:departhist   -961.0      466.2  -2.061  0.04109 *  \npub_c:departsoc   -1115.0      495.4  -2.251  0.02592 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard deviation: 15670 on 144 degrees of freedom\nMultiple R-squared: 0.1892\nF-statistic: 6.722 on 5 and 144 DF,  p-value: 1.167e-05 \n    AIC     BIC \n3331.44 3352.51 \n\nplot(predictorEffects(mod, ~depart, xlevels = 3))\n\n\n\nplot(predictorEffects(mod, ~pub_c))\n\n\n\n\n연차의 효과를 통제?\n\nmod2 <- lm(salary ~ (time_c + pub_c) * depart, data = acad3)"
  },
  {
    "objectID": "contents/interaction.html#categorical-vs.-categorical",
    "href": "contents/interaction.html#categorical-vs.-categorical",
    "title": "Interaction Effects",
    "section": "Categorical vs. Categorical",
    "text": "Categorical vs. Categorical\nANOVA: factorical design\n\n실험연구의 예\n실험연구 분석에 대한 더 논의가 필요함…\nData: C0901DT.csv  Data: C0902DT.csv \n\n\n관찰연구의 예\n성별과 결혼 여부에 따른 임금차이\n\ncps <- mosaicData::CPS85 |> as_tibble()\ncps |> head(5)\n\n# A tibble: 5 × 11\n   wage  educ race  sex   hispanic south married exper union   age sector  \n  <dbl> <int> <fct> <fct> <fct>    <fct> <fct>   <int> <fct> <int> <fct>   \n1   9      10 W     M     NH       NS    Married    27 Not      43 const   \n2   5.5    12 W     M     NH       NS    Married    20 Not      38 sales   \n3   3.8    12 W     F     NH       NS    Single      4 Not      22 sales   \n4  10.5    12 W     F     NH       NS    Married    29 Not      47 clerical\n5  15      12 W     M     NH       NS    Married    40 Union    58 const   \n\nmod <- lm(wage ~ sex * married, data = cps)\nS(mod)\n\nCall: lm(formula = wage ~ sex * married, data = cps)\n\nCoefficients:\n                   Estimate Std. Error t value Pr(>|t|)    \n(Intercept)          7.6838     0.3898  19.711  < 2e-16 ***\nsexM                 3.1923     0.5319   6.002 3.62e-09 ***\nmarriedSingle        0.5759     0.6697   0.860  0.39026    \nsexM:marriedSingle  -3.0972     0.9073  -3.414  0.00069 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard deviation: 4.962 on 530 degrees of freedom\nMultiple R-squared: 0.07314\nF-statistic: 13.94 on 3 and 530 DF,  p-value: 9.234e-09 \n    AIC     BIC \n3232.05 3253.45 \n\npredictorEffects(mod) |> plot()\n\n\n\n\n관찰연구의 경우 confounding이 될만한 통제 변수를 충분히 고려해야 하고, 나이가 성별과 결혼 여부와 상관관계가 있으므로 통제 변수로 포함.\n\ncps |> select(age, sex, married) |> lowerCor()\n\n         age   sex*  mrrd*\nage       1.00            \nsex*     -0.08  1.00      \nmarried* -0.28  0.01  1.00\n\n# age와 wage의 관계는 비선형적: spline regression (piecewise polynomial) fit을 고려할 필요있음\nmod2 <- lm(wage ~ sex * married + age + I(age^2), data = cps)  \npredictorEffects(mod2, ~ sex + married) |> plot()\n\n\n\nS(mod2)\n\nCall: lm(formula = wage ~ sex * married + age + I(age^2), data = cps)\n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        -5.147951   2.391631  -2.152  0.03181 *  \nsexM                3.152425   0.516297   6.106 1.98e-09 ***\nmarriedSingle       1.321511   0.662608   1.994  0.04662 *  \nage                 0.608443   0.121565   5.005 7.62e-07 ***\nI(age^2)           -0.006630   0.001483  -4.470 9.60e-06 ***\nsexM:marriedSingle -2.617902   0.887868  -2.949  0.00333 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard deviation: 4.816 on 528 degrees of freedom\nMultiple R-squared: 0.1301\nF-statistic:  15.8 on 5 and 528 DF,  p-value: 1.649e-14 \n    AIC     BIC \n3202.17 3232.13 \n\n\n결혼 유무에 따른 임금의 차이는 여성의 경우 미혼이 $1.32(p = 0.047) 높음.\n남성의 경우는 아래와 같이 factor level을 변경해서 보면, 남성인 경우 미혼이 $1.29(p = 0.041) 낮음.\n\nmod2_m <- lm(wage ~ fct_relevel(sex, \"M\") * married + age + I(age^2), data = cps)\nS(mod2_m)\n\nCall: lm(formula = wage ~ fct_relevel(sex, \"M\") * married + age + I(age^2),\n         data = cps)\n\nCoefficients:\n                                      Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                          -1.995525   2.393324  -0.834  0.40478    \nfct_relevel(sex, \"M\")F               -3.152425   0.516297  -6.106 1.98e-09 ***\nmarriedSingle                        -1.296391   0.632255  -2.050  0.04082 *  \nage                                   0.608443   0.121565   5.005 7.62e-07 ***\nI(age^2)                             -0.006630   0.001483  -4.470 9.60e-06 ***\nfct_relevel(sex, \"M\")F:marriedSingle  2.617902   0.887868   2.949  0.00333 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard deviation: 4.816 on 528 degrees of freedom\nMultiple R-squared: 0.1301\nF-statistic:  15.8 on 5 and 528 DF,  p-value: 1.649e-14 \n    AIC     BIC \n3202.17 3232.13"
  }
]