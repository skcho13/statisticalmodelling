<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sungkyun Cho">
<meta name="dcterms.date" content="2025-03-06">

<title>Case 1 –  CHA Statistics in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../contents/case2.html" rel="next">
<link href="../contents/regression2.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-a842e9d0d04a6f4978ea162b780f9ff5.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f495038607379a14ef1ad9f9ac9e1fa1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3JGE58SZ6T"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-3JGE58SZ6T', { 'anonymize_ip': true});
</script>


<meta property="og:title" content="Case 1 –  CHA Statistics in R">
<meta property="og:description" content="Applied Multiple Regression/Correlation Analysis for the Behavioral Sciences by Jacob Cohen, Patricia Cohen, Stephen G. West, Leona S. Aiken">
<meta property="og:image" content="https://r.modellings.art/contents/images/mediation_maternal.png">
<meta property="og:site_name" content="CHA Statistics in R">
<meta property="og:image:height" content="640">
<meta property="og:image:width" content="1388">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Case 1</h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../"><i class="fa-solid fa-chart-bar" aria-label="chart-bar"></i> CHA Statistics in R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/notice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notice</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">R tutorial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/baser.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidyverse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Import</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualize</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/regression1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../contents/regression2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Case 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Papers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Categorical IVs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diagnostics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inference</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Communicate</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://docs.google.com/document/d/1OQ1D7d4MxEfMZmo_FLj29rGWqvWADKmGc_QD9g5h_ho/edit?usp=sharing" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ask</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#leerkes-and-crockenberg-1999의-육아에-대한-효능감-연구" id="toc-leerkes-and-crockenberg-1999의-육아에-대한-효능감-연구" class="nav-link active" data-scroll-target="#leerkes-and-crockenberg-1999의-육아에-대한-효능감-연구">Leerkes and Crockenberg (1999)의 육아에 대한 효능감 연구</a></li>
  <li><a href="#mediation-analysis-매개-분석" id="toc-mediation-analysis-매개-분석" class="nav-link" data-scroll-target="#mediation-analysis-매개-분석">Mediation Analysis (매개 분석)</a>
  <ul>
  <li><a href="#psych-패키지의-mediate" id="toc-psych-패키지의-mediate" class="nav-link" data-scroll-target="#psych-패키지의-mediate"><code>psych</code> 패키지의 <code>mediate()</code></a></li>
  <li><a href="#process-macro-by-andrew-f.-hayes" id="toc-process-macro-by-andrew-f.-hayes" class="nav-link" data-scroll-target="#process-macro-by-andrew-f.-hayes">Process Macro by Andrew F. Hayes</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Case 1</h1>
<p class="subtitle lead">Applied Multiple Regression/Correlation Analysis for the Behavioral Sciences by Jacob Cohen, Patricia Cohen, Stephen G. West, Leona S. Aiken</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sungkyun Cho </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 6, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="leerkes-and-crockenberg-1999의-육아에-대한-효능감-연구" class="level2">
<h2 class="anchored" data-anchor-id="leerkes-and-crockenberg-1999의-육아에-대한-효능감-연구">Leerkes and Crockenberg (1999)의 육아에 대한 효능감 연구</h2>
<p><em>Source: Statistical Methods for Psychology (8e) by Dave C. Howell</em></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li>5개월의 아기를 양육하는 92명의 어머니를 대상</li>
<li>본인이 아이였을 때 어머니에게 받은 양육(maternal care) 정도가 자신이 어머니가 되었을 때 아이를 향한 양육효능감으로 이전될 것이라는 가설</li>
<li>매개변수로 maternal care로부터 영향을 받은 자존감(self-esteem)을 고려.</li>
<li>데이터: <a href="https://www.dropbox.com/s/gwqqfkge8rqb2a9/MediationData.sav?dl=1">maternal_care.sav</a></li>
</ul>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/mediation_maternal.png" class="img-fluid" width="450"></p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>maternal <span class="ot">&lt;-</span> <span class="fu">read_spss</span>(<span class="st">"howell/maternal_care.sav"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>maternal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 92 × 4
   FAMID Esteem MatCare Efficacy
   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1     1   3.83    2.58      3.7
 2     2   3.5     2.83      3.4
 3     4   4       3.17      3.8
 4     8   4       3.75      3.9
 5     9   4       3.58      3.9
 6    11   3.33    3.67      3.7
 7    12   3.5     3.25      3.8
 8    13   3.67    3.75      3.5
 9    15   1.83    3.17      3.1
10    16   2.83    2.67      3.5
# ℹ 82 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlations</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(psych)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lowerCor</span>(maternal[<span class="sc">-</span><span class="dv">1</span>])  <span class="co"># lowerCor(maternal[2:4])과 동일 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Estem MatCr Effcc
Esteem   1.00             
MatCare  0.40  1.00       
Efficacy 0.38  0.27  1.00 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(maternal[<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case1_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Efficacy <span class="sc">~</span> MatCare, <span class="at">data =</span> maternal)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Efficacy <span class="sc">~</span> MatCare <span class="sc">+</span> Esteem, <span class="at">data =</span> maternal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare models</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(jtools)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">export_summs</span>(mod1, mod2, <span class="at">error_format =</span> <span class="st">"(p = {p.value})"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>                ───────────────────────────────────────────────
                                   Model 1         Model 2     
                              ─────────────────────────────────
                  (Intercept)        3.27 ***        2.94 ***  
                                (p = 0.00)&nbsp;&nbsp;&nbsp;   (p = 0.00)&nbsp;&nbsp;&nbsp;  
                  MatCare            0.11 *&nbsp;&nbsp;        0.06&nbsp;&nbsp;&nbsp;&nbsp;  
                                (p = 0.01)&nbsp;&nbsp;&nbsp;   (p = 0.20)&nbsp;&nbsp;&nbsp;  
                  Esteem              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        0.15 **&nbsp;  
                                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   (p = 0.00)&nbsp;&nbsp;&nbsp;  
                              ─────────────────────────────────
                  N                 92&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       92&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
                  R2                 0.07&nbsp;&nbsp;&nbsp;&nbsp;        0.16&nbsp;&nbsp;&nbsp;&nbsp;  
                ───────────────────────────────────────────────
                  *** p &lt; 0.001; ** p &lt; 0.01; * p &lt;            
                  0.05.                                        

Column names: names, Model 1, Model 2</code></pre>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summ</span>(mod2, <span class="at">part.corr =</span> <span class="cn">TRUE</span>, <span class="at">model.info =</span> <span class="cn">FALSE</span>, <span class="at">model.fit =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard errors:OLS
--------------------------------------------------------------------
                    Est.   S.E.   t val.      p   partial.r   part.r
----------------- ------ ------ -------- ------ ----------- --------
(Intercept)         2.94   0.17    16.95   0.00                     
MatCare             0.06   0.04     1.30   0.20        0.14     0.13
Esteem              0.15   0.05     3.02   0.00        0.31     0.29
--------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mediation-analysis-매개-분석" class="level2">
<h2 class="anchored" data-anchor-id="mediation-analysis-매개-분석">Mediation Analysis (매개 분석)</h2>
<p>Baron, R. M., &amp; Kenny, D. A. (1986). <a href="https://davidakenny.net/cm/mediate.htm">David A. Kenny website</a></p>
<ul>
<li>많은 문제점들이 지적되었으며, 이후 계속 extensively revised</li>
<li>인과 추론에 대한 큰 틀에서 새롭게 접근할 필요가 있음</li>
</ul>
<p>참고: <a href="https://theeffectbook.net/index.html">The Effect: An Introduction to Research Design and Causality</a></p>
<p>독립변수가 종속변수에 어떻게(how) 영향을 주는지를 파악; 기제(메커니즘)을 파악<br>
기제를 파악하는 것은 개입의 효과가 어떻게 일어나는지에 대한 핵심 요소를 규정할 수 있고, 변화과정을 최적화 할 수 있도록 도움을 줌.<br>
매개 효과는 인과에 대한 강력한 주장을 하는 것이고, 회귀 분석이 기본적으로는 상관관계에 기초한다는 점에서 항상 인과관계에 대해서는 다양한 검증과 깊은 연구가 필요함</p>
<ul>
<li>변수들 간의 관계에 대한 충분히 설득력있는 이론적 근거가 필요</li>
<li>추가적 실험 설계나 사전 연구들로 보완해야 함</li>
<li>변수들 간의 관계를 왜곡할 수 있는 변수들을 모두 분석에 포함해야 함</li>
</ul>
<p>일반적으로 여러 변수 간의 관계를 동시에 추정하는 SEM(structural equation modeling)의 프레임워크로 분석함</p>
<p><strong>매개효과 존재의 검증?</strong></p>
<p><img src="images/mediation-confounding.png" class="img-fluid" width="650"></p>
<ol type="1">
<li>X → M의 인과 관계를 실험적으로 검증</li>
<li>M → Y의 인과 관계를 실험적으로 검증</li>
</ol>
<p>이 때, X → Y의 인과 관계가 유추되는가?</p>
<p>만약, N을 거쳐가는 효과가 존재한다면?</p>
<ul>
<li>X → Y의 효과는 0이거나 마이너스가 될 수 있음.</li>
<li>실제 X → Y의 효과가 없는 경우에도 매개효과를 찾으려는 노력을 하기를 제안하고 있음.</li>
</ul>
<ol start="3" type="1">
<li>이제 X → Y의 인과 관계를 실험적으로 검증하면 되는가?</li>
</ol>
<p>M이 Y보다 이전에 발생한 것이라는 근거는? Y → M을 발생시킬 수 없는가?</p>
<p>참고, 직접 효과(direct effect) vs.&nbsp;간접 효과(indirect effect)의 표현에서 직접효과라는 표현보다는 omiited mediator라는 표현을 사용하는 것이 더 적절함.</p>
<section id="psych-패키지의-mediate" class="level3">
<h3 class="anchored" data-anchor-id="psych-패키지의-mediate"><code>psych</code> 패키지의 <code>mediate()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(psych)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fit_Efficacy <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">mediate</span>(Efficacy <span class="sc">~</span> MatCare <span class="sc">+</span> (Esteem), <span class="at">data =</span> maternal)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_Efficacy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/efficacy-diagram.png" class="img-fluid" width="700"></p>
<!-- ### Causal Mediation Analysis: `mediation` 패키지의 `mediate()`
참고: help(mediate)

- ACME: Average Causal Mediation Effects
- ADE: Average Direct Effects
- Total Effect: indirect + direct effects
- Prop. Mediated: ACME / Total Effect


fitM <- lm(Esteem ~ MatCare, data = maternal)
fitY <- lm(Efficacy ~ Esteem + MatCare, data = maternal)

# library(mediation)
fitMed <- mediation::mediate(fitM, fitY, treat="MatCare", mediator="Esteem", boot=TRUE)
summary(fitMed)
plot(fitMed)
 -->
</section>
<section id="process-macro-by-andrew-f.-hayes" class="level3">
<h3 class="anchored" data-anchor-id="process-macro-by-andrew-f.-hayes">Process Macro by Andrew F. Hayes</h3>
<p><a href="https://afhayes.com/index.html">Andrew F. Hayes website</a><br>
<a href="https://www.afhayes.com/public/processv43.zip">Macro download link</a>: PROCESS v4.3 for R 폴더 안에 있는 process.R 파일을 이용</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"process.R"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">process</span>(<span class="at">data=</span>maternal, <span class="at">y=</span><span class="st">"Efficacy"</span>, <span class="at">m=</span><span class="st">"Esteem"</span>, <span class="at">x=</span><span class="st">"MatCare"</span>, <span class="at">model=</span><span class="dv">4</span>, <span class="at">total=</span><span class="dv">1</span>, <span class="at">bc=</span><span class="dv">1</span>, <span class="at">boot=</span><span class="dv">1000</span>) <span class="co"># stand=1: standardized coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/process-1.png" class="img-fluid" width="700"></p>
<p><img src="images/process-2.png" class="img-fluid" width="700"></p>
<p><strong>통제 변수를 함께 고려한 예</strong></p>
<div style="line-height: 1.5em; font-size: .9em">
<p>Source: <em>p.133, Introduction to Mediation, Moderation, and Conditional Process Analysis: A Regression-Based Approach by Andrew F. Hayes</em></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>이를 설명하기 위해 3.5절에서 설명한 경제적 스트레스 연구를 다시 살펴보겠습니다. Pollack 등(2012)은 262명의 기업가들이 경기 침체기에 경험한 경제적 스트레스와 비즈니스 관련 우울한 영향, 그리고 창업 철수 의도를 평가한 바 있습니다. 단순 매개 분석 결과, 경제적 스트레스가 우울 정서에 미치는 영향을 통해 간접적으로 사업에서 철수하려는 욕구를 유발할 수 있다는 주장과 일치하는 결과가 나왔습니다. 즉, 경제적 스트레스를 더 많이 경험했다고 응답한 사람들은 사업 관련 우울 정서를 더 강하게 느꼈고(a = 0.173), 우울 정서를 더 많이 경험한 사람들은 경제적 스트레스를 보정한 후에도 창업 철회 의도가 더 높았습니다(b = 0.769). 간접 효과는 통계적으로 0과 차이가 없었습니다(ab = 0.133, 95% 부트스트랩 신뢰 구간은 0.071~0.201). 경제적 스트레스가 탈퇴 의도에 미치는 직접적인 영향에 대한 증거는 없었습니다(c′ = -0.077, p = .144). 간접적인 효과는 스트레스가 높아지면 우울한 정서로 이어져 창업 철회 의도로 이어지는 일련의 사건을 반영할 수 있습니다. 하지만 이러한 데이터는 단발성 관찰 연구에서 나온 결과라는 점을 기억하세요. 어떤 것도 조작되지 않았고, 시간이 지남에 따라 측정된 것도 없으며, 잠재적인 혼동 가능성이 많습니다. 예를 들어, 간접 효과는 비즈니스 관리에 대한 자신의 자신감이나 기술에 대한 인식과 같은 개인차가 아닌 다른 것에 의해 나타날 수 있습니다. 자신의 능력에 대해 상대적으로 더 자신감을 느끼는 사람들은 일반적으로 스트레스를 상대적으로 덜 느끼는 경향이 있고, 어떤 상황에서도 자신의 사업에 대해 부정적이고 낙담하는 경향이 적으며, 자신감이 낮은 사람보다 상대적으로 더 일을 즐기는 경향이 있을 수 있습니다. 그렇다면 경제적 스트레스의 간접 효과를 평가할 때 이러한 개인차를 통계적으로 통제하면 그 효과가 약화되거나 제거되어야 합니다. 즉, 자신감이 동일한 사람들 사이에서 경제적 스트레스가 우울한 영향을 통해 인출 의도에 미치는 간접 효과의 증거가 없어야 하는데, 이 추론에 따르면 이 변수는 X와 M, M과 Y 사이의 허위 연관성을 유도하는 과정에서 제거되었기 때문입니다. 그러나 자신감을 일정하게 유지하더라도 간접 효과가 지속된다면 인과 관계 주장은 여전히 유효합니다. 이 대안적 설명은 신뢰도와 유사한 무언가가 측정된 경우에만 시험해 볼 수 있습니다. 다행히도 Pollack 등(2012)은 “기업가적 자기 효능감”(Chen, Green, &amp; Crick, 1998)이라는 측정치를 포함시켰습니다. 이 측정은 목표 설정 및 달성, 신제품 개발, 위험 관리, 의사 결정 등 다양한 기업가정신 관련 업무를 성공적으로 수행할 수 있는 자신의 능력에 대한 자신감을 지수화한 것입니다(ESTRESS 데이터 파일에 있는 ESE). 실제로 기업가적 자기효능감이 상대적으로 낮은 집단에 비해 기업가적 자기효능감이 상대적으로 높은 집단은 경제적 스트레스를 상대적으로 덜 느끼고(r = -0.158, p = .010), 비즈니스 관련 우울 영향을 상대적으로 덜 받으며(r = -0.246, p &lt; .001), 기업가정신에 대한 몰입 의도가 상대적으로 약하다고 응답했습니다(r = -0.243, p &lt; .001). 따라서 경제적 스트레스, 우울한 정동, 철수 의도 간에 관찰된 관계 중 적어도 일부에 대해서는 가짜 연관성 또는 표피적 연관성이 그럴듯한 대체 설명이 될 수 있습니다. 기업가적 자기 효능감과 추정 중인 인과 모형의 주요 변수 간의 공통된 연관성을 설명하기 위해 기업가적 자기 효능감(C1)을 우울 정동(M)과 철수 의도(Y) 모두에 대한 방정식에 포함시켰습니다. 또한 단일 변수가 통계적 통제변수로 사용될 수 있음을 설명하기 위해 참여자의 성별(데이터의 SEX, 0 = 여성, 1 = 남성)과 비즈니스에 종사한 기간(년 단위, C3, 데이터의 TENURE)을 예측변수로 포함시켰습니다. 따라서 경제적 스트레스의 직간접적 영향을 정량화하기 위해 추정된 방정식은 다음과 같습니다.</p>
<p>이러한 종류의 분석은 이러한 통제 없이 비교 분석의 결과가 통제 대상 변수를 포함하는 대체 설명에 얼마나 민감하거나 취약한지를 확인하기 위해 수행하거나, 특정 변수가 인과 체계의 주요 변수 간에 가짜 연관성을 생성할 수 있다는 것이 선험적으로 알려져 있거나 예비 분석에 근거하여 수행될 수 있습니다. 일시적인 현상이나 가짜 연관성을 대체 설명으로 배제하는 것은 본질적으로 상관관계만 있는 연관성을 포함하는 모든 인과 관계 논증에서 중요한 부분입니다. 하지만 그렇다고 해서 이러한 효과를 인과관계로 일률적으로 해석할 수 있다는 의미는 아닙니다. 물론 이 분석에서 고려되지 않은 다른 혼란 변수가 X, M, Y 사이에 관찰된 연관성을 만들어내고 있을 수 있습니다. 이것이 이 접근법의 문제점 중 하나입니다. 측정된 잠재적 혼동 변수만 설명할 수 있으며, 올바른 잠재적 혼동 변수가 존재한다면 통계적으로 통제되었는지 여부를 알 수 없습니다. 연관성에 대해 이러한 대체 해석이 존재할 수 있을 때 할 수 있는 최선의 방법은 이러한 교란 위협을 예상하고, 연구 중에 이를 측정하며, 분석에서 수학적으로 설명할 수 없는 그럴듯한 대체 교란 변수를 생각해낼 수 있는 비평가가 없기를 바라는 것입니다.</p>
</div>
</div>
</div>
<p><img src="images/hayes-mediation-1.png" class="img-fluid" width="600"></p>
<p><img src="images/estress-table.png" class="img-fluid" width="600"></p>
<p><a href="https://afhayes.com/public/hayes2022data.zip">Data files link</a> from <a href="https://afhayes.com/introduction-to-mediation-moderation-and-conditional-process-analysis.html">Andrew F. Hayes</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>estress <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"data/hayes2022data/estress/estress.sav"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">process</span>(<span class="at">data=</span>estress, <span class="at">y=</span><span class="st">"withdraw"</span>, <span class="at">x=</span><span class="st">"estress"</span>, <span class="at">m=</span><span class="st">"affect"</span>, <span class="at">cov=</span><span class="fu">c</span>(<span class="st">"ese"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sex"</span>,<span class="st">"tenure"</span>), <span class="at">total=</span><span class="dv">1</span>, <span class="at">model=</span><span class="dv">4</span>)  <span class="co"># total: includes total effect</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/process-3.png" class="img-fluid" width="700"></p>
<p><img src="images/process-4.png" class="img-fluid" width="700"></p>
<p>psych 패키지의 <code>mediate()</code>를 사용하면,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>estress <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"data/hayes2022data/estress/estress.sav"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>fit_estress <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">mediate</span>(withdraw <span class="sc">~</span> estress <span class="sc">+</span> (affect) <span class="sc">+</span> ese <span class="sc">+</span> sex, <span class="at">data =</span> estress)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_estress)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: psych::mediate(y = withdraw ~ estress + (affect) + ese + sex, 
    data = estress)

Direct effect estimates (traditional regression)    (c') X + M on Y 
          withdraw   se     t  df     Prob
Intercept     2.73 0.54  5.04 257 8.91e-07
estress      -0.09 0.05 -1.80 257 7.25e-02
ese          -0.21 0.08 -2.78 257 5.92e-03
sex           0.13 0.14  0.89 257 3.76e-01
affect        0.71 0.10  6.81 257 6.70e-11

R = 0.45 R2 = 0.21   F = 16.66 on 4 and 257 DF   p-value:  3.76e-12 

 Total effect estimates (c) (X on Y) 
          withdraw   se     t  df     Prob
Intercept     3.94 0.55  7.11 258 1.14e-11
estress       0.02 0.05  0.30 258 7.62e-01
ese          -0.32 0.08 -3.94 258 1.03e-04
sex           0.14 0.16  0.89 258 3.73e-01

 'a'  effect estimates (X on M) 
          affect   se     t  df     Prob
Intercept   1.71 0.31  5.60 258 5.50e-08
estress     0.16 0.03  5.25 258 3.22e-07
ese        -0.15 0.04 -3.39 258 7.95e-04
sex         0.02 0.09  0.19 258 8.50e-01

 'b'  effect estimates (M on Y controlling for X) 
       withdraw  se    t  df    Prob
affect     0.71 0.1 6.81 257 6.7e-11

 'ab'  effect estimates (through all  mediators)
        withdraw  boot   sd lower upper
estress     0.11  0.11 0.03  0.06  0.17
ese        -0.11 -0.10 0.04  0.06  0.17
sex         0.01  0.02 0.06  0.06  0.17</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/r\.modellings\.art");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../contents/regression2.html" class="pagination-link" aria-label="Multiple Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Multiple Regression</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../contents/case2.html" class="pagination-link" aria-label="Case 2">
        <span class="nav-page-text">Case 2</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This work © 2024 by Sungkyun Cho is licensed under CC BY-NC-SA 4.0</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>