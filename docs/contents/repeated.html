<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sungkyun Cho">
<meta name="dcterms.date" content="2023-02-17">

<title>CHA Stats in R - Repeated ANOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../contents/report.html" rel="next">
<link href="../contents/inference.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Repeated ANOVA</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">CHA Stats in R</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/notice.html" class="sidebar-item-text sidebar-link">Notice</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">R tutorial</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/setup.html" class="sidebar-item-text sidebar-link">Setup</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/baser.html" class="sidebar-item-text sidebar-link">Base R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/tidyverse.html" class="sidebar-item-text sidebar-link">Tidyverse</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/import.html" class="sidebar-item-text sidebar-link">Import</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/cleaning.html" class="sidebar-item-text sidebar-link">Cleaning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/visualize.html" class="sidebar-item-text sidebar-link">Visualize</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Statistics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/overview.html" class="sidebar-item-text sidebar-link">Overview</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/regression1.html" class="sidebar-item-text sidebar-link">Simple Regression</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../contents/regression2.html" class="sidebar-item-text sidebar-link">Multiple Regression</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case1.html" class="sidebar-item-text sidebar-link">Case Study 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case2.html" class="sidebar-item-text sidebar-link">Case Study 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case3.html" class="sidebar-item-text sidebar-link">Case Study 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case3_sol.html" class="sidebar-item-text sidebar-link">Case Study 3 Sol</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case4.html" class="sidebar-item-text sidebar-link">Salary</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/categorical.html" class="sidebar-item-text sidebar-link">Categorical IVs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/interaction.html" class="sidebar-item-text sidebar-link">Interactions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/inference.html" class="sidebar-item-text sidebar-link">Inference</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/repeated.html" class="sidebar-item-text sidebar-link active">Repeated ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/report.html" class="sidebar-item-text sidebar-link">Report</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Communicate</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://docs.google.com/document/d/1LjSKjc3bAd0OY9H7BH_0MXp0RhCSOlWhGpq6zoDzAiY/edit?usp=sharing" class="sidebar-item-text sidebar-link">Ask</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://docs.google.com/document/d/1NjaZzQdVq22csZLMuCI9GDZmTY-hFHypkFlEBb4Yx9s/edit?usp=sharing" class="sidebar-item-text sidebar-link">Consult</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://docs.google.com/document/d/1rznMbrQOfHBnYIJvWE-T6YW5jN0yBXQGiohDVLS5Qp4/edit?usp=sharing" class="sidebar-item-text sidebar-link">Group Project</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#newborn-language" id="toc-newborn-language" class="nav-link active" data-scroll-target="#newborn-language">Newborn Language</a>
  <ul>
  <li><a href="#exercise-5.3." id="toc-exercise-5.3." class="nav-link" data-scroll-target="#exercise-5.3.">Exercise 5.3.</a></li>
  <li><a href="#exercise-5.4." id="toc-exercise-5.4." class="nav-link" data-scroll-target="#exercise-5.4.">Exercise 5.4.</a>
  <ul class="collapse">
  <li><a href="#repeated-measures-anova" id="toc-repeated-measures-anova" class="nav-link" data-scroll-target="#repeated-measures-anova">Repeated-measures ANOVA</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#bilingual-data" id="toc-bilingual-data" class="nav-link" data-scroll-target="#bilingual-data">Bilingual data</a></li>
  <li><a href="#between-subjects-bs-anova" id="toc-between-subjects-bs-anova" class="nav-link" data-scroll-target="#between-subjects-bs-anova">Between-subjects (BS) ANOVA</a>
  <ul>
  <li><a href="#post-hoc-tests" id="toc-post-hoc-tests" class="nav-link" data-scroll-target="#post-hoc-tests">Post-hoc tests</a></li>
  <li><a href="#exercise-5.8." id="toc-exercise-5.8." class="nav-link" data-scroll-target="#exercise-5.8.">Exercise 5.8.</a></li>
  </ul></li>
  <li><a href="#linear-models-and-linear-mixed-effects-models-in-r-with-linguistic-applications" id="toc-linear-models-and-linear-mixed-effects-models-in-r-with-linguistic-applications" class="nav-link" data-scroll-target="#linear-models-and-linear-mixed-effects-models-in-r-with-linguistic-applications">Linear models and linear mixed effects models in R with linguistic applications</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Repeated ANOVA</h1>
<p class="subtitle lead">http://coltekin.net/cagri/R/r-exercisesse5.html</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sungkyun Cho </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 17, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="newborn-language" class="level1">
<h1>Newborn Language</h1>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="43">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>newborn <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/newborn.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>newborn <span class="ot">&lt;-</span> newborn <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">participant =</span> <span class="fu">factor</span>(participant),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">language =</span> <span class="fu">factor</span>(language)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>newborn <span class="sc">|&gt;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 x 3
  participant language  rate
  &lt;fct&gt;       &lt;fct&gt;    &lt;dbl&gt;
1 1           native    29.0
2 1           foreign   20.1
3 2           native    29.5
4 2           foreign   31.6
5 3           native    50.9
6 3           foreign   53.7
# i 54 more rows</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="44">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wide format</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>newborn_wide <span class="ot">&lt;-</span> newborn <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"language"</span>, <span class="at">values_from =</span> <span class="st">"rate"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">diff =</span> native <span class="sc">-</span> foreign)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>newborn_wide <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 x 4
  participant native foreign   diff
  &lt;fct&gt;        &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 1             29.0    20.1  8.95 
2 2             29.5    31.6 -2.11 
3 3             50.9    53.7 -2.81 
4 4             55.2    47.7  7.44 
5 5             26.8    25.9  0.970
6 6             45.1    37.6  7.57 
# i 24 more rows</code></pre>
</div>
</div>
<section id="exercise-5.3." class="level2">
<h2 class="anchored" data-anchor-id="exercise-5.3.">Exercise 5.3.</h2>
<p>Assuming the newborn data came from two independent groups of babies (no baby is tested twice), test whether the babies respond diﬀerently to their native language and the foreign language.</p>
<p>Two normal Q-Q plots, one for each language, and var.test() testing for equivalence of variances would be ways to test for normality and homogeneity of variance assumptions. A boxplot() is also useful for visualizing the distributions of both groups.</p>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="46">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>newborn <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> language, <span class="at">y =</span> rate)) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="repeated_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="50">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>newborn <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> language, <span class="at">y =</span> rate, <span class="at">group =</span> participant, <span class="at">color =</span> <span class="fu">as.numeric</span>(participant))) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>participant)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="repeated_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="51">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>mod_ind <span class="ot">&lt;-</span> <span class="fu">lm</span>(rate <span class="sc">~</span> language, <span class="at">data =</span> newborn)  <span class="co"># assumes independence</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod_ind) <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 5
  term           estimate std.error statistic  p.value
  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)       31.8       1.87     17.0  3.39e-24
2 languagenative     4.52      2.65      1.71 9.31e- 2</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="19">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(rate <span class="sc">~</span> language, <span class="at">data =</span> newborn)  <span class="co"># assumes independence</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Welch Two Sample t-test

data:  rate by language
t = -1.7074, df = 57.994, p-value = 0.0931
alternative hypothesis: true difference in means between group foreign and group native is not equal to 0
95 percent confidence interval:
 -9.8271059  0.7797726
sample estimates:
mean in group foreign  mean in group native 
             31.84367              36.36733 </code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="53">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(mod_ind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>6</li><li>54</li></ol>
</div>
<div class="cell-output cell-output-display">
<p><img src="repeated_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="60">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residualPlots</span>(mod_ind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="repeated_files/figure-html/cell-14-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="55">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(rate <span class="sc">~</span> language, <span class="at">data =</span> newborn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    F test to compare two variances

data:  rate by language
F = 0.98053, num df = 29, denom df = 29, p-value = 0.9581
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.4666972 2.0600871
sample estimates:
ratio of variances 
         0.9805289 </code></pre>
</div>
</div>
</section>
<section id="exercise-5.4." class="level2">
<h2 class="anchored" data-anchor-id="exercise-5.4.">Exercise 5.4.</h2>
<p>Perform a paired t test. Compare your results and to the independent-samples t test you have just performed.</p>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="61">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(rate <span class="sc">~</span> language, <span class="at">data =</span> newborn, <span class="at">paired=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Paired t-test

data:  rate by language
t = -5.3138, df = 29, p-value = 1.06e-05
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -6.264775 -2.782559
sample estimates:
mean difference 
      -4.523667 </code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="64">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>newborn_wide <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 x 4
  participant native foreign   diff
  &lt;fct&gt;        &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 1             29.0    20.1  8.95 
2 2             29.5    31.6 -2.11 
3 3             50.9    53.7 -2.81 
4 4             55.2    47.7  7.44 
5 5             26.8    25.9  0.970
6 6             45.1    37.6  7.57 
# i 24 more rows</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="73">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>newborn_wide <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> diff)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="repeated_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="62">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(newborn_wide<span class="sc">$</span>diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>13</li><li>22</li></ol>
</div>
<div class="cell-output cell-output-display">
<p><img src="repeated_files/figure-html/cell-19-output-2.png" class="img-fluid"></p>
</div>
</div>
<section id="repeated-measures-anova" class="level3">
<h3 class="anchored" data-anchor-id="repeated-measures-anova">Repeated-measures ANOVA</h3>
<p>In this case, we tell aov() that the response corresponding to every level of language is measured for each participant. The speciﬁcation of the error term could be confusing at ﬁrst sight. Within the Error() term, the part before the slash ‘/’ speciﬁes the ‘case’ or ‘subject’ variable. The part after the slash speciﬁes the ‘within subject’ variable(s).</p>
<p>However, aov() does not run any diagnostics or present corrected results in case of violation of the assumptions, does not report any eﬀect size, cannot handle unbalanced designs or missing data.</p>
<p>We will only present an example using ezANOVA() from the package ez. However, when things are not perfectly balanced, and neat, the repeated-measures ANOVA becomes diﬃcult to interpret. One reasonable course of action when ANOVA design becomes too complicated, or assumptions are violated at some level is to switch to so-called mixed-eﬀect models which also oﬀer some other beneﬁts.</p>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="86">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">aov</span>(rate <span class="sc">~</span> language <span class="sc">+</span> <span class="fu">Error</span>(participant <span class="sc">/</span> language), <span class="at">data =</span> newborn)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Error: participant
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 29   5792   199.7               

Error: participant:language
          Df Sum Sq Mean Sq F value   Pr(&gt;F)    
language   1  306.9  306.95   28.24 1.06e-05 ***
Residuals 29  315.2   10.87                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="74">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ez)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The ez package defaults to the “median-centered” ANOVA, which is usually more robust then “mean-centered”.</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The ez package also defaults to the “Satterthwaite” approximation for the degrees of freedom, which is usually more robust than the “Kenward-Roger” approximation.</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ezANOVA</span>(<span class="at">data =</span> newborn, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">dv =</span> rate, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">wid =</span> participant,, </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">within =</span> language, </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">detailed =</span> <span class="cn">TRUE</span>, </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="dv">3</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">return_aov =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>$ANOVA
       Effect DFn DFd        SSn      SSd        F            p p&lt;.05
1 (Intercept)   1  29 69791.1078 5791.737 349.4534 1.015654e-17     *
2    language   1  29   306.9534  315.251  28.2367 1.060479e-05     *
         ges
1 0.91953700
2 0.04785722

$aov

Call:
aov(formula = formula(aov_formula), data = data)

Grand Mean: 34.1055

Stratum 1: participant

Terms:
                Residuals
Sum of Squares   5791.737
Deg. of Freedom        29

Residual standard error: 14.13206

Stratum 2: participant:language

Terms:
                language Residuals
Sum of Squares  306.9534  315.2511
Deg. of Freedom        1        29

Residual standard error: 3.297078
Estimated effects are balanced</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="76">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>model_lmer <span class="ot">&lt;-</span> <span class="fu">lmer</span>(rate <span class="sc">~</span> language <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant), <span class="at">data =</span> newborn)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: rate ~ language + (1 | participant)
   Data: newborn

REML criterion at convergence: 394.2

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.79385 -0.50665 -0.03044  0.42331  2.00234 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 94.42    9.717   
 Residual                10.87    3.297   
Number of obs: 60, groups:  participant, 30

Fixed effects:
               Estimate Std. Error t value
(Intercept)     31.8437     1.8734  16.997
languagenative   4.5237     0.8513   5.314

Correlation of Fixed Effects:
            (Intr)
languagentv -0.227</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="78">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(model_lmer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="repeated_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="bilingual-data" class="level1">
<h1>Bilingual data</h1>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="81">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>bilingual <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/bilingual.csv"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>bilingual <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 120 x 5
   subj language  age         gender   mlu
  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
1     1 school    preschool   F       3.06
2     1 school    firstgrade  F       3.63
3     1 school    secondgrade F       2.71
4     1 home.only preschool   F       3.71
5     1 home.only firstgrade  F       4.70
6     1 home.only secondgrade F       4.31
# i 114 more rows</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="83">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>bilingual <span class="ot">&lt;-</span> bilingual <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">subj =</span> <span class="fu">factor</span>(subj),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">age =</span> <span class="fu">factor</span>(age, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"preschool"</span>, <span class="st">"firstgrade"</span>, <span class="st">"secondgrade"</span>)),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">language =</span> <span class="fu">factor</span>(language)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="84">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>bilingual_wide <span class="ot">&lt;-</span> bilingual <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"age"</span>, <span class="at">values_from =</span> <span class="st">"mlu"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>bilingual_wide <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 x 6
  subj  language  gender preschool firstgrade secondgrade
  &lt;fct&gt; &lt;fct&gt;     &lt;fct&gt;      &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
1 1     school    F           3.06       3.63        2.71
2 1     home.only F           3.71       4.70        4.31
3 2     school    F           3.87       4.60        7.39
4 2     home.only F           3.08       4.33        5.50
5 3     school    F           3.11       3.51        4.00
6 3     home.only F           2.97       2.91        3.52
# i 34 more rows</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="90">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>bilingual <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> mlu, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>language)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="repeated_files/figure-html/cell-29-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="88">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>bilingual <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> mlu, <span class="at">group =</span> subj, <span class="at">color =</span> <span class="fu">as.numeric</span>(subj))) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#geom_jitter(width = .2, aes(color = as.numeric(subj))) +</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>gender <span class="sc">+</span> language)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="repeated_files/figure-html/cell-30-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="between-subjects-bs-anova" class="level1">
<h1>Between-subjects (BS) ANOVA</h1>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="92">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ezPlot</span>(<span class="at">data    =</span> bilingual <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">subj =</span> <span class="fu">factor</span>(<span class="fu">row_number</span>())),</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dv      =</span> mlu, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">wid     =</span> subj, </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">between =</span> .(gender, age), </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x       =</span> age, </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">split   =</span> gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="repeated_files/figure-html/cell-31-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="97">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>bilingual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A tibble: 120 x 5</caption>
<thead>
    <tr><th scope="col">subj</th><th scope="col">language</th><th scope="col">age</th><th scope="col">gender</th><th scope="col">mlu</th></tr>
    <tr><th scope="col">&lt;fct&gt;</th><th scope="col">&lt;fct&gt;</th><th scope="col">&lt;fct&gt;</th><th scope="col">&lt;fct&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><td>1</td><td>school   </td><td>preschool  </td><td>F</td><td>3.059997</td></tr>
    <tr><td>1</td><td>school   </td><td>firstgrade </td><td>F</td><td>3.627408</td></tr>
    <tr><td>1</td><td>school   </td><td>secondgrade</td><td>F</td><td>2.712001</td></tr>
    <tr><td>1</td><td>home.only</td><td>preschool  </td><td>F</td><td>3.714177</td></tr>
    <tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
    <tr><td>20</td><td>school   </td><td>secondgrade</td><td>M</td><td>4.196580</td></tr>
    <tr><td>20</td><td>home.only</td><td>preschool  </td><td>M</td><td>2.723715</td></tr>
    <tr><td>20</td><td>home.only</td><td>firstgrade </td><td>M</td><td>2.880923</td></tr>
    <tr><td>20</td><td>home.only</td><td>secondgrade</td><td>M</td><td>3.548740</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="100">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>easy <span class="ot">&lt;-</span> <span class="fu">ezANOVA</span>(<span class="at">data     =</span> bilingual <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">subj_new =</span> <span class="fu">factor</span>(<span class="fu">row_number</span>())), </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">dv       =</span> mlu, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">wid      =</span> subj_new, </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">between  =</span> .(gender, age), </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">detailed =</span> <span class="cn">TRUE</span>, </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">type     =</span> <span class="dv">3</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">return_aov =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>easy <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$ANOVA
       Effect DFn DFd          SSn      SSd            F            p p&lt;.05
1 (Intercept)   1 114 2.492216e+03 218.4438 1.300621e+03 3.528100e-64     *
2      gender   1 114 2.108673e-03 218.4438 1.100461e-03 9.735945e-01      
3         age   2 114 3.549801e+01 218.4438 9.262735e+00 1.872895e-04     *
4  gender:age   2 114 1.318330e+00 218.4438 3.440006e-01 7.096618e-01      
           ges
1 9.194131e-01
2 9.653070e-06
3 1.397880e-01
4 5.998895e-03

$`Levene's Test for Homogeneity of Variance`
  DFn DFd      SSn      SSd        F         p p&lt;.05
1   5 114 5.104009 79.95702 1.455425 0.2099949      

$aov
Call:
   aov(formula = formula(aov_formula), data = data)

Terms:
                   gender       age gender:age Residuals
Sum of Squares    0.00211  35.49801    1.31833 218.44377
Deg. of Freedom         1         2          2       114

Residual standard error: 1.384259
Estimated effects may be unbalanced
</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="107">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(mlu <span class="sc">~</span> gender <span class="sc">*</span> age, <span class="at">data =</span> bilingual))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
gender        1   0.00   0.002   0.001 0.973594    
age           2  35.50  17.749   9.263 0.000187 ***
gender:age    2   1.32   0.659   0.344 0.709662    
Residuals   114 218.44   1.916                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="195">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(mlu <span class="sc">~</span> gender <span class="sc">*</span> age, <span class="at">data =</span> bilingual))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = mlu ~ gender * age, data = bilingual)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4190 -0.9188 -0.0358  0.9336  4.5814 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              4.0989     0.3095  13.242   &lt;2e-16 ***
genderM                 -0.2882     0.4377  -0.658   0.5116    
agefirstgrade            0.3221     0.4377   0.736   0.4633    
agesecondgrade           1.0655     0.4377   2.434   0.0165 *  
genderM:agefirstgrade    0.3348     0.6191   0.541   0.5896    
genderM:agesecondgrade   0.5046     0.6191   0.815   0.4168    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.384 on 114 degrees of freedom
Multiple R-squared:  0.1442,    Adjusted R-squared:  0.1067 
F-statistic: 3.843 on 5 and 114 DF,  p-value: 0.002964</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="199">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/rempsyc/vignettes/assumptions.html</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(mod_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="repeated_files/figure-html/cell-36-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="post-hoc-tests" class="level3">
<h3 class="anchored" data-anchor-id="post-hoc-tests">Post-hoc tests</h3>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="108">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = mlu ~ gender * age, data = bilingual)

$gender
           diff      lwr       upr     p adj
M-F -0.00838386 -0.50904 0.4922723 0.9735945

$age
                            diff         lwr      upr     p adj
firstgrade-preschool   0.4895386 -0.24550638 1.224584 0.2577451
secondgrade-preschool  1.3178208  0.58277575 2.052866 0.0001257
secondgrade-firstgrade 0.8282821  0.09323712 1.563327 0.0230832

$`gender:age`
                                   diff         lwr      upr     p adj
M:preschool-F:preschool     -0.28818497 -1.55709891 0.980729 0.9860237
F:firstgrade-F:preschool     0.32211418 -0.94679976 1.591028 0.9770407
M:firstgrade-F:preschool     0.36877810 -0.90013584 1.637692 0.9588345
F:secondgrade-F:preschool    1.06554354 -0.20337040 2.334457 0.1533815
M:secondgrade-F:preschool    1.28191300  0.01299906 2.550827 0.0461831
F:firstgrade-M:preschool     0.61029915 -0.65861479 1.879213 0.7304340
M:firstgrade-M:preschool     0.65696307 -0.61195087 1.925877 0.6644590
F:secondgrade-M:preschool    1.35372850  0.08481456 2.622642 0.0293182
M:secondgrade-M:preschool    1.57009797  0.30118403 2.839012 0.0064201
M:firstgrade-F:firstgrade    0.04666392 -1.22225002 1.315578 0.9999980
F:secondgrade-F:firstgrade   0.74342936 -0.52548458 2.012343 0.5357460
M:secondgrade-F:firstgrade   0.95979882 -0.30911512 2.228713 0.2493164
F:secondgrade-M:firstgrade   0.69676543 -0.57214851 1.965679 0.6056730
M:secondgrade-M:firstgrade   0.91313490 -0.35577904 2.182049 0.3019832
M:secondgrade-F:secondgrade  0.21636946 -1.05254448 1.485283 0.9962906</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="123">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(bilingual<span class="sc">$</span>mlu, </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">interaction</span>(bilingual<span class="sc">$</span>age, bilingual<span class="sc">$</span>gender),</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">paired=</span>F, </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  bilingual$mlu and interaction(bilingual$age, bilingual$gender) 

              preschool.F firstgrade.F secondgrade.F preschool.M firstgrade.M
firstgrade.F  1.0000      -            -             -           -           
secondgrade.F 0.2472      1.0000       -             -           -           
preschool.M   1.0000      1.0000       0.0374        -           -           
firstgrade.M  1.0000      1.0000       1.0000        1.0000      -           
secondgrade.M 0.0617      0.4555       1.0000        0.0074      0.5881      

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="136">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_repeated <span class="ot">&lt;-</span> <span class="fu">aov</span>(mlu <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">Error</span>(subj <span class="sc">/</span> (age)), <span class="at">data =</span> bilingual))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Error: subj
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 19  129.8   6.833               

Error: subj:age
          Df Sum Sq Mean Sq F value   Pr(&gt;F)    
age        2  35.50  17.749   17.76 3.58e-06 ***
Residuals 38  37.97   0.999                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Error: Within
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 60  51.97  0.8662               </code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="142">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ezPlot</span>(<span class="at">data =</span> bilingual, <span class="at">dv =</span> mlu, <span class="at">wid =</span> subj, <span class="at">within =</span> .(age, language), </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> age, <span class="at">split =</span> language)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ezPlot</span>(<span class="at">data =</span> bilingual, <span class="at">dv =</span> mlu, <span class="at">wid =</span> subj, <span class="at">within =</span>.(age, language), </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> language, <span class="at">split =</span> age)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="repeated_files/figure-html/cell-40-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="143">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>bilingual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A tibble: 120 x 5</caption>
<thead>
    <tr><th scope="col">subj</th><th scope="col">language</th><th scope="col">age</th><th scope="col">gender</th><th scope="col">mlu</th></tr>
    <tr><th scope="col">&lt;fct&gt;</th><th scope="col">&lt;fct&gt;</th><th scope="col">&lt;fct&gt;</th><th scope="col">&lt;fct&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><td>1</td><td>school   </td><td>preschool  </td><td>F</td><td>3.059997</td></tr>
    <tr><td>1</td><td>school   </td><td>firstgrade </td><td>F</td><td>3.627408</td></tr>
    <tr><td>1</td><td>school   </td><td>secondgrade</td><td>F</td><td>2.712001</td></tr>
    <tr><td>1</td><td>home.only</td><td>preschool  </td><td>F</td><td>3.714177</td></tr>
    <tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
    <tr><td>20</td><td>school   </td><td>secondgrade</td><td>M</td><td>4.196580</td></tr>
    <tr><td>20</td><td>home.only</td><td>preschool  </td><td>M</td><td>2.723715</td></tr>
    <tr><td>20</td><td>home.only</td><td>firstgrade </td><td>M</td><td>2.880923</td></tr>
    <tr><td>20</td><td>home.only</td><td>secondgrade</td><td>M</td><td>3.548740</td></tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="exercise-5.8." class="level2">
<h2 class="anchored" data-anchor-id="exercise-5.8.">Exercise 5.8.</h2>
<p>Perform a repeated measures ANOVA that tests the eﬀect of language and age on mlu in the bilingual data set</p>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ez)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The ez package defaults to the “median-centered” ANOVA, which is usually more robust then “mean-centered”.</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The ez package also defaults to the “Satterthwaite” approximation for the degrees of freedom, which is usually more robust than the “Kenward-Roger” approximation.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="153">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>mod_bilingual <span class="ot">&lt;-</span> <span class="fu">ezANOVA</span>(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> bilingual,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">dv =</span> mlu,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">wid =</span> .(subj),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">within =</span> .(language, age),</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">between =</span> gender,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="dv">3</span>,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># detailed = TRUE, </span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># return_aov = TRUE</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>mod_bilingual <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$ANOVA
               Effect DFn DFd       F       p p&lt;.05     ges
2              gender   1  18 2.9e-04 9.9e-01       0.00001
3            language   1  18 6.8e+00 1.8e-02     * 0.03377
5                 age   2  36 1.7e+01 5.1e-06     * 0.14702
4     gender:language   1  18 2.0e-01 6.6e-01       0.00102
6          gender:age   2  36 6.5e-01 5.3e-01       0.00636
7        language:age   2  36 3.1e+00 5.9e-02       0.01659
8 gender:language:age   2  36 1.4e+00 2.5e-01       0.00776

$`Mauchly's Test for Sphericity`
               Effect    W    p p&lt;.05
5                 age 0.99 0.95      
6          gender:age 0.99 0.95      
7        language:age 0.99 0.92      
8 gender:language:age 0.99 0.92      

$`Sphericity Corrections`
               Effect  GGe   p[GG] p[GG]&lt;.05 HFe   p[HF] p[HF]&lt;.05
5                 age 0.99 5.4e-06         * 1.1 5.1e-06         *
6          gender:age 0.99 5.3e-01           1.1 5.3e-01          
7        language:age 0.99 5.9e-02           1.1 5.9e-02          
8 gender:language:age 0.99 2.5e-01           1.1 2.5e-01          
</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="165">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>mlm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="at">data =</span> bilingual, mlu <span class="sc">~</span> age<span class="sc">*</span>language <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subj))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="166">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: mlu ~ age * language + (1 | subj)
   Data: bilingual

REML criterion at convergence: 360.8

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.48540 -0.54268 -0.04216  0.55965  2.27307 

Random effects:
 Groups   Name        Variance Std.Dev.
 subj     (Intercept) 0.9997   0.9999  
 Residual             0.8344   0.9135  
Number of obs: 120, groups:  subj, 20

Fixed effects:
                              Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)                     3.8880     0.3028 45.8663  12.839  &lt; 2e-16 ***
agefirstgrade                   0.3625     0.2889 95.0000   1.255  0.21262    
agesecondgrade                  0.9106     0.2889 95.0000   3.152  0.00217 ** 
languageschool                  0.1336     0.2889 95.0000   0.462  0.64482    
agefirstgrade:languageschool    0.2541     0.4085 95.0000   0.622  0.53538    
agesecondgrade:languageschool   0.8145     0.4085 95.0000   1.994  0.04903 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) agfrst agscnd lnggsc agfrs:
agefirstgrd -0.477                            
agesecndgrd -0.477  0.500                     
languagschl -0.477  0.500  0.500              
agfrstgrd:l  0.337 -0.707 -0.354 -0.707       
agscndgrd:l  0.337 -0.354 -0.707 -0.707  0.500</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="170">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(mlm) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict mlu with age and language (formula: mlu ~ age * language). The model
included subj as random effect (formula: ~1 | subj). The model's total
explanatory power is substantial (conditional R2 = 0.62) and the part related
to the fixed effects alone (marginal R2) is of 0.17. The model's intercept,
corresponding to age = preschool and language = home.only, is at 3.89 (95% CI
[3.29, 4.49], t(112) = 12.84, p &lt; .001). Within this model:

  - The effect of age [firstgrade] is statistically non-significant and positive
(beta = 0.36, 95% CI [-0.21, 0.93], t(112) = 1.25, p = 0.212; Std. beta = 0.25,
95% CI [-0.14, 0.64])
  - The effect of age [secondgrade] is statistically significant and positive
(beta = 0.91, 95% CI [0.34, 1.48], t(112) = 3.15, p = 0.002; Std. beta = 0.62,
95% CI [0.23, 1.01])
  - The effect of language [school] is statistically non-significant and positive
(beta = 0.13, 95% CI [-0.44, 0.71], t(112) = 0.46, p = 0.645; Std. beta = 0.09,
95% CI [-0.30, 0.48])
  - The interaction effect of language [school] on age [firstgrade] is
statistically non-significant and positive (beta = 0.25, 95% CI [-0.56, 1.06],
t(112) = 0.62, p = 0.535; Std. beta = 0.17, 95% CI [-0.38, 0.73])
  - The interaction effect of language [school] on age [secondgrade] is
statistically significant and positive (beta = 0.81, 95% CI [5.10e-03, 1.62],
t(112) = 1.99, p = 0.049; Std. beta = 0.56, 95% CI [3.49e-03, 1.11])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
</section>
</section>
<section id="linear-models-and-linear-mixed-effects-models-in-r-with-linguistic-applications" class="level1">
<h1>Linear models and linear mixed effects models in R with linguistic applications</h1>
<p>By Bodo Winter</p>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="171">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>politeness <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/politeness_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="175">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>politeness <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 84 x 5
  subject gender scenario attitude frequency
  &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;
1 F1      F             1 pol           213.
2 F1      F             1 inf           204.
3 F1      F             2 pol           285.
4 F1      F             2 inf           260.
5 F1      F             3 pol           204.
6 F1      F             3 inf           287.
# i 78 more rows</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="193">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lmer</span>(frequency <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> subject) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> scenario), <span class="at">data =</span> politeness))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: frequency ~ 1 + (1 | subject) + (1 | scenario)
   Data: politeness

REML criterion at convergence: 810.3

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.41151 -0.53646 -0.09084  0.63767  2.81003 

Random effects:
 Groups   Name        Variance Std.Dev.
 scenario (Intercept)  205.4   14.33   
 subject  (Intercept) 3990.7   63.17   
 Residual              751.2   27.41   
Number of obs: 83, groups:  scenario, 7; subject, 6

Fixed effects:
            Estimate Std. Error     df t value Pr(&gt;|t|)    
(Intercept)   192.88      26.52   5.43   7.272 0.000538 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="183">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>mod_polite <span class="ot">&lt;-</span> <span class="fu">lmer</span>(frequency <span class="sc">~</span> attitude <span class="sc">+</span> gender <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> attitude <span class="sc">|</span> subject) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> attitude <span class="sc">|</span> scenario), <span class="at">data =</span> politeness)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="184">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>mod_polite</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Linear mixed model fit by REML ['lmerModLmerTest']
Formula: frequency ~ attitude + gender + (1 + attitude | subject) + (1 +  
    attitude | scenario)
   Data: politeness
REML criterion at convergence: 775.0777
Random effects:
 Groups   Name        Std.Dev. Corr
 scenario (Intercept) 14.267       
          attitudepol  8.430   0.00
 subject  (Intercept) 24.248       
          attitudepol  1.216   1.00
 Residual             25.049       
Number of obs: 83, groups:  scenario, 7; subject, 6
Fixed Effects:
(Intercept)  attitudepol      genderM  
     258.14       -19.75      -111.11  
optimizer (nloptwrap) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings </code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="185">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_polite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: frequency ~ attitude + gender + (1 + attitude | subject) + (1 +  
    attitude | scenario)
   Data: politeness

REML criterion at convergence: 775.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.1306 -0.6205 -0.1005  0.5024  3.3606 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 scenario (Intercept) 203.555  14.267       
          attitudepol  71.067   8.430   0.00
 subject  (Intercept) 587.983  24.248       
          attitudepol   1.478   1.216   1.00
 Residual             627.446  25.049       
Number of obs: 83, groups:  scenario, 7; subject, 6

Fixed effects:
            Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept)  258.141     15.864    5.060  16.272 1.45e-05 ***
attitudepol  -19.754      6.380    6.072  -3.096  0.02089 *  
genderM     -111.106     20.942    4.007  -5.305  0.00604 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) atttdp
attitudepol -0.100       
genderM     -0.660  0.002
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../contents/inference.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../contents/report.html" class="pagination-link">
        <span class="nav-page-text">Report</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">This work © 2023 by Sungkyun Cho is licensed under CC BY-NC-SA 4.0</div>   
  </div>
</footer>



</body></html>