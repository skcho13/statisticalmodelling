<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sungkyun Cho">
<meta name="dcterms.date" content="2024-06-17">

<title> CHA Statistics in R - Statistical Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../contents/diagnostics.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3JGE58SZ6T"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-3JGE58SZ6T', { 'anonymize_ip': true});
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Statistical Inference</h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../"><i class="fa-solid fa-chart-bar" aria-label="chart-bar"></i> CHA Statistics in R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/notice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notice</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">R tutorial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/baser.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidyverse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Import</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualize</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/regression1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../contents/regression2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case Study 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case Study 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case Study 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case3_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case Study 3 Sol</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case Study 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/case5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Papers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Categorical IVs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diagnostics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/inference.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Inference</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Communicate</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://docs.google.com/document/d/1OQ1D7d4MxEfMZmo_FLj29rGWqvWADKmGc_QD9g5h_ho/edit?usp=sharing" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ask</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#confidence-interval" id="toc-confidence-interval" class="nav-link active" data-scroll-target="#confidence-interval">Confidence Interval</a>
  <ul>
  <li><a href="#the-sampling-distribution-of-the-mean" id="toc-the-sampling-distribution-of-the-mean" class="nav-link" data-scroll-target="#the-sampling-distribution-of-the-mean">The Sampling Distribution of the Mean</a></li>
  <li><a href="#regression-model-coefficients" id="toc-regression-model-coefficients" class="nav-link" data-scroll-target="#regression-model-coefficients">Regression Model Coefficients</a></li>
  </ul></li>
  <li><a href="#resampling-methods-bootstrap" id="toc-resampling-methods-bootstrap" class="nav-link" data-scroll-target="#resampling-methods-bootstrap">Resampling Methods: Bootstrap</a>
  <ul>
  <li><a href="#multiple-regression에-적용" id="toc-multiple-regression에-적용" class="nav-link" data-scroll-target="#multiple-regression에-적용">Multiple Regression에 적용</a></li>
  <li><a href="#mediation-analysis에-적용" id="toc-mediation-analysis에-적용" class="nav-link" data-scroll-target="#mediation-analysis에-적용">Mediation Analysis에 적용</a>
  <ul class="collapse">
  <li><a href="#boot-패키지의-boot-활용" id="toc-boot-패키지의-boot-활용" class="nav-link" data-scroll-target="#boot-패키지의-boot-활용">boot 패키지의 <code>boot()</code> 활용</a></li>
  <li><a href="#lavaan-패키지의-활용-sem-분석툴" id="toc-lavaan-패키지의-활용-sem-분석툴" class="nav-link" data-scroll-target="#lavaan-패키지의-활용-sem-분석툴">lavaan 패키지의 활용: SEM 분석툴</a></li>
  </ul></li>
  <li><a href="#moderated-mediation에-응용" id="toc-moderated-mediation에-응용" class="nav-link" data-scroll-target="#moderated-mediation에-응용">Moderated Mediation에 응용</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Statistical Inference</h1>
<p class="subtitle lead">Applied Multiple Regression/Correlation Analysis for the Behavioral by Jacob Cohen, Patricia Cohen, Stephen G. West, Leona S. AikenSciences</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sungkyun Cho </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 17, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="confidence-interval" class="level1">
<h1>Confidence Interval</h1>
<p>평균이 <span class="math inline">\(\mu\)</span> 이고 분산이 <span class="math inline">\(\sigma^2\)</span> 인 모집단으로부터 추출된 표본 사이즈가 <span class="math inline">\(n\)</span> (size=<span class="math inline">\(n\)</span>)인 표본들에 대해서<br>
<img src="images/sampling2.png" class="img-fluid" width="400"><br>
Source: <em>The Truthful Art</em> by Albert Cairo.</p>
<p>표본 <strong>평균</strong>들 <span class="math inline">\(\bar{X}\)</span> 의 분포를 <strong>평균의 표본 분포, the sampling distribution of the mean </strong>이라고 하고, 이 분포는 the central limit theorem에 의해</p>
<ul>
<li><p>평균:&nbsp; <span class="math inline">\(\displaystyle E(\bar{X})=\frac{m_1+m_2+m_3+\cdots+m_w}{w}\Bigg|_{w\rightarrow\infty}\rightarrow ~~~\mu\)</span> ; unbiased estimator (mean or regression coefficient vs.&nbsp;R)</p></li>
<li><p>분산:&nbsp; <span class="math inline">\(\displaystyle V(\bar{X})\Bigg|_{w\rightarrow\infty}\rightarrow ~~~\frac{\sigma^2}{n},\)</span>   표준 편차 <span class="math inline">\(\displaystyle\frac{\sigma}{\sqrt{n}}\)</span> 를 <strong>standard error of estimate</strong> (SE)라고 함.</p>
<ul>
<li>이 standard error of estimate는 다시 말하면, 어떤 통계치(여기서는 평균)가 표본들 간에 얼마나 차이가 나는지를 알 수 있는 중요한 지표가 됨.</li>
</ul></li>
<li><p>분포: 모집단의 분포가 normal에 가까울 수록, 또는 표본 크기가 클수록 ( <span class="math inline">\(n\rightarrow\infty, n &gt; 30\)</span> ) <span class="math inline">\(\displaystyle\{m_1, m_2, m_3, \cdots, m_w, \cdots\} \sim N(\mu, \frac{\sigma}{\sqrt{n}}) : normal ~ distribution\)</span> (정규 분포)</p></li>
<li><p>값을 정규화하면; <span class="math inline">\(\displaystyle Z=\frac{X-\mu}{\frac{\sigma}{\sqrt{n}}}\)</span></p>
<p>분포: <span class="math inline">\(\displaystyle\{z_1, z_2, z_3, \cdots, z_w, \cdots\} \sim N(0, 1) : standard ~ normal ~ distribution\)</span> (표준 정균 분포)</p></li>
</ul>
<p>실제 예를 통해서 살펴보면,<br>
예를 들어 어느 섬에 사는 민족의 남성 평균 키가 아래와 같은 분포를 가진다고 할 때 (평균: 173cm, 표준편차: 5cm),<br>
관찰한 <strong>100명의 한 표본</strong>에서 남성들의 키가 평균 174cm로 관찰되었다면 이 정도로 큰 값이 나올 가능성은 얼마정도 인가?</p>
<section id="the-sampling-distribution-of-the-mean" class="level2">
<h2 class="anchored" data-anchor-id="the-sampling-distribution-of-the-mean">The Sampling Distribution of the Mean</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[1, 1]">
<div class="quarto-layout-row">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">

</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[1, 1]">
<div class="quarto-layout-row">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="inference_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="inference_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="inference_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="inference_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>(b)의 경우 즉, 표본 사이즈가 n = 100인 경우처럼 평균의 표본 분포는 빠르게 <strong>정규 분포</strong>에 다가가므로 근사적으로 정규 분포의 값을 이용해 그 확률 값을 쉽게 구할 수 있음.<br>
특히, 값들을 정규화하여 표준정규분포 (평균 0, 표준편차 1)의 값을 이용함.</p>
<p><span class="math inline">\(\displaystyle \frac{174 - 173}{0.5} = 2, ~~ \bar{Z}=\frac{\bar{X}-\mu}{\frac{\sigma}{\sqrt{n}}}\)</span></p>
<p>음영된 부분은 대략 2.3%이고, 따라서 100명을 관찰한 표본의 평균 키가 174cm이상이 될 가능성은 2.3%에 밖에 되지 않음. 예를 들어, 1000번 같은 연구를 반복하면 23번 정도는 174cm 이상의 평균 키를 관찰할 수 있을 것임.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="inference_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
</div>
</div>
<p>실제 성취하고자 하는 유용한 분석은 위 과정의 반대인, 관찰한 특정 표본으로부터 모집단에 대해 추론하는 것임.<br>
이를 <strong>통계적 추론, statistical inference</strong>라고 함.</p>
<p>가령, 어느 섬에 사는 민족으로부터 관찰된 100명의 키의 평균이 175cm이고 표준편차가 10cm인 경우, 이 민족의 키의 평균은 얼마 정도라고 파악할 수 있는가?</p>
<ul>
<li>먼저, 모집단의 평균 <span class="math inline">\(\mu\)</span> 를 <strong>가정</strong>하는데, 가령 <span class="math inline">\(\mu = 173\)</span> 라면, 우리가 관찰한 표본의 평균 175는 충분히 나올 수 있는 값인가? 이에 대해서는 위의 논리에 따라 구할 수 있음. 즉,
<ul>
<li><span class="math inline">\(\displaystyle \frac{175 - 173}{\frac{\sigma}{10}} = ~?, ~~ \bar{Z}=\frac{\bar{X}-\mu}{\frac{\sigma}{\sqrt{n}}}\)</span></li>
<li>만약, 모집단의 표준편차 <span class="math inline">\(\sigma\)</span> 가 예전처럼 5라면, <span class="math inline">\(\bar{Z} = 4\)</span> 가 되어 매우 희박한 경우가 될 것임. (실제로 0.0032%)</li>
<li>모집단의 표준편차를 알 수 없기 때문에 차선책으로, 관찰한 <strong>표본의 표준편차</strong>를 대체해서 전개함</li>
<li>이 경우, 표본의 표준편차가 10이기 때문에, <span class="math inline">\(\bar{Z} = 2\)</span> 가 되어 2.3% 정도의 가능성이 있다고 볼 수 있으나,</li>
<li>표준편차의 대체로 인해 생기는 문제를 보완할 수 있는데, 사실 표본분포가 정규분포가 아닌 Student’s t-분포를 따르고, 이를 이용해서 확률값을 구함.</li>
<li>이 경우는 <span class="math inline">\(\displaystyle t = \frac{\bar{X}-\mu}{\frac{s}{\sqrt{n}}} = 2, ~ (s: the ~sample ~sd)\)</span> 로 t-분포에 의하면 2.4% 정도의 가능성이 있다고 봄
<ul>
<li>t-분포는 자유도(degree of freedom)에 의해 분포가 바뀌는데 df는 n-1 (n: 표본 크기)</li>
</ul></li>
</ul></li>
<li>이제 위의 과정을 계속 반복한다고 상상하면, 즉 모집단의 평균을 다른 값으로 가정하면서,
<ul>
<li>관찰된 표본 평균 175cm가 95% (양 극단 2.5%를 제외한) 이내에서 관찰될 수 있는 모집단의 평균들을 모두 찾을 수 있음</li>
<li>이 평균들의 범위를 95% <strong>confidence interval</strong> 이라고 부르고,</li>
<li>식으로 전개하면, <span class="math inline">\(\displaystyle\Bigg| \frac{m-\mu}{\frac{s}{\sqrt{n}}} \Bigg| &lt; 1.66, ~(n=100)\)</span><br>
<span class="math inline">\(\displaystyle m-1.66\frac{s}{\sqrt{n}} &lt; \mu &lt; m + 1.66\frac{s}{\sqrt{n}}\)</span></li>
<li>위 예의 경우 <span class="math inline">\(\displaystyle 173.34 &lt; \mu &lt; 176.66\)</span></li>
<li>즉, 우리는 95%의 확신을 갖고, 이 섬에 사는 민족의 평균 키는 173.34cm에서 176.66cm 사이에 있을 것이라고 말할 수 있음.</li>
<li>이 cofidence interval의 크기를 결정하는 것은 <span class="math inline">\(\displaystyle\frac{s}{\sqrt{n}}\)</span> 즉, <strong>standard error of estimate</strong>인데, 범위가 좁아질수록, <strong>precision</strong>이 높다고 표현함.</li>
<li>한편, 99%의 확신으로 (confidence level: 99%)는 그 키의 범위를 더 넓혀서 말할 수 있음. 이 경우 <span class="math inline">\(|~t~| &lt; 2.36\)</span> 으로부터 모집단의 키가 (172.64cm, 177.36cm) 범위가 있다고 말할 수 있음.
<ul>
<li>확신이 커지는 대신 범위가 넓어지므로 모집단의 예측에 대한 유용성이 떨어짐.</li>
</ul></li>
</ul></li>
</ul>
<p><strong>가설 검정(hypothesis testing)</strong><br>
회귀분석 결과표의 p-values들은 영가설(null hypothesis)을 테스트하는 것이며, 위에서 평균이 0이라고 가정하는 경우에 해당</p>
<ul>
<li>가설/가정: “모집단의 평균 키가 0cm이라면”, 표본에서 관찰된 175cm는 충분히 나올 수 있는 값인가?
<ul>
<li>절편(intercept)만 있는 null 모형(<span class="math inline">\(\hat y = b_0\)</span>)에 대한 절편에 대한 가설 검증.</li>
</ul></li>
<li>회귀계수 b에 대한 테스트도 마찬가지로, 표본분포가 근사적으로 정규분포를 따르므로, 적절한 표준편차를 얻어 위와 같은 방식으로 테스트를 할 수 있음.</li>
</ul>
</section>
<section id="regression-model-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="regression-model-coefficients">Regression Model Coefficients</h2>
<p>위의 논리와 비슷하게 회귀 계수가 표본 마다 얼마나 변하는 지를 구할 수 있고,<br>
회귀 계수에 대한 confidence interval을 구할 수 있음.<br>
변수가 한 개인 경우:<br>
회귀계수 <span class="math inline">\(b\)</span> 에 대한 표본 분포는 평균이 <span class="math inline">\(b\)</span> 인 정규분포를 따르고, 표준편차 즉, standard error of estimate는 근사적으로 다음과 같음</p>
<p><span class="math inline">\(\displaystyle SE^2(b) = \frac{{MS}_{residual}}{N \cdot Var(X)}\)</span></p>
<p>Confidence interval: <span class="math inline">\(b\pm t_{\alpha/2}SE, ~(df = N-2)\)</span></p>
<p>다중 회귀 모형의 경우:<br>
예측변수 <span class="math inline">\(X_j\)</span> 에 대해서 모집단의 회귀계수 <span class="math inline">\(b_j\)</span> 에 대한 표본 분포는 평균이 <span class="math inline">\(b_j\)</span> 인 정규분포를 따르고, 표준편차, 즉 standard error는 근사적으로 다음과 같음.</p>
<p><span class="math inline">\(\displaystyle SE^2(b_j) = \frac{{MS}_{residual}}{N \cdot Var(X_j) \cdot (1 - R^2_j)} = \frac{{MS}_{residual}}{N \cdot Var(X_j)}\cdot VIF, ~(df = N-k-1)\)</span></p>
<ul>
<li>표본 사이즈가 클수록</li>
<li>평균 잔차가 작을수록</li>
<li>j번째 예측변수의 값이 퍼져 있을수록</li>
<li>다른 예측변수들로부터 j번째 예측변수가 예측되지 못할수록; 즉 다른 변수들과 correlate되지 않을수록
<ul>
<li><span class="math inline">\(1 - R^2_j\)</span>: tolerance, 그 역수: variance inflation factor (VIF)</li>
<li>Tolerance가 극히 작은 것은 intolerable! 봐줄 수 없음!</li>
<li>예를 들어, 어느 문화에서 남자아이에게는 자기 주장이 강하도록 훈육하고, 여자아이에게는 반대로 훈육한다고 할 때,<br>
만약, 자기주장이 강하도록 부모가 교육하는 것이 자녀가 자기주장이 강하게 되는데 영향을 미친다는 것을 살펴보는데, 성별을 통계적으로 통제한다면, 훈육의 효과는 통계적으로 계산되기 어려워짐.<br>
이는 성별과 훈육방식이 큰 상관관계를 갖기 때문에, 성별과 독립적인 훈육의 변량이 작아져 회귀계수의 precision이 크게 낮아지기 때문임.</li>
</ul></li>
</ul>
</section>
</section>
<section id="resampling-methods-bootstrap" class="level1">
<h1>Resampling Methods: Bootstrap</h1>
<ul>
<li>모집단에 대한 추론을 하는데 “특정 분포”로부터 표본들이 생성된 것이라고 가정하고 이론에 기반한 추론 하는 방식과 달리</li>
<li>관찰된 표본이 모집단의 특성을 잘 반영하고 있다는 전제하에</li>
<li>이 표본을 모집단인듯이 취급하여 이 표본으로부터 표본을 (복원) 추출하여 많은 표본들을 얻은 후 (<strong>resampling</strong>)</li>
<li>각 표본들로부터 통계치를 계산하여 “표본 분포”을 얻는 방식 (sampling distribution)</li>
<li>Bootstrap외에도 다양한 resampling 방법이 있음.</li>
</ul>
<section id="multiple-regression에-적용" class="level2">
<h2 class="anchored" data-anchor-id="multiple-regression에-적용">Multiple Regression에 적용</h2>
<p><strong>car 패키지의 <code>Boot()</code> 이용</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Prestige2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Prestige)  <span class="co"># Boot() 함수는 결측치(NA)를 처리하지 못함</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>mod_prestige <span class="ot">&lt;-</span> <span class="fu">lm</span>(prestige <span class="sc">~</span> education <span class="sc">+</span> <span class="fu">log2</span>(income) <span class="sc">+</span> type, <span class="at">data =</span> Prestige2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>prestige_boot <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">Boot</span>(mod_prestige, <span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Confint</span>(prestige_boot) <span class="sc">%&gt;%</span> <span class="fu">round</span>(., <span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap bca confidence intervals

             Estimate    2.5 %  97.5 %
(Intercept)   -81.202 -105.620 -53.944
education       3.284    2.100   4.449
log2(income)    7.269    4.991   9.411
typeprof        6.751    0.458  12.978
typewc         -1.439   -5.314   2.986</code></pre>
</div>
</div>
<p><code>education</code> 파라미터 추정치 1000개의 분포</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>prestige_boot<span class="sc">$</span>t <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> education)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">4.4</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="inference_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="600"></p>
</figure>
</div>
</div>
</div>
<!-- ```{r}
hist(prestige_boot, parm = "education", den.col = "orangered", nor.col = "deepskyblue2", col = "white")
``` -->
<p><strong>parameters 패키지의 <code>model_parameters()</code> 이용</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(mod_prestige, <span class="at">boot=</span><span class="cn">TRUE</span>, <span class="at">ci_method=</span><span class="st">"bci"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter     | Coefficient |            95% CI |      p
--------------------------------------------------------
(Intercept)   |      -81.63 | [-106.07, -56.29] | &lt; .001
education     |        3.25 | [   2.13,   4.37] | &lt; .001
income [log2] |        7.37 | [   5.00,   9.39] | &lt; .001
type [prof]   |        6.88 | [   0.91,  12.90] | 0.026 
type [wc]     |       -1.36 | [  -5.25,   3.10] | 0.518 </code></pre>
</div>
</div>
</section>
<section id="mediation-analysis에-적용" class="level2">
<h2 class="anchored" data-anchor-id="mediation-analysis에-적용">Mediation Analysis에 적용</h2>
<p><img src="images/mediation_maternal.png" class="img-fluid" width="450"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>maternal <span class="ot">&lt;-</span> <span class="fu">read_spss</span>(<span class="st">"howell/maternal_care.sav"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>maternal <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(maternal)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>maternal <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  FAMID Esteem MatCare Efficacy
  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1     1   3.83    2.58      3.7
2     2   3.5     2.83      3.4
3     4   4       3.17      3.8
4     8   4       3.75      3.9
5     9   4       3.58      3.9</code></pre>
</div>
</div>
<section id="boot-패키지의-boot-활용" class="level3">
<h3 class="anchored" data-anchor-id="boot-패키지의-boot-활용">boot 패키지의 <code>boot()</code> 활용</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 함수 정의</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>indirect_effect <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> data[indices, ]  <span class="co"># 부트스트랩 샘플링</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  model_M <span class="ot">&lt;-</span> <span class="fu">lm</span>(Esteem <span class="sc">~</span> MatCare, <span class="at">data =</span> sample)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  model_Y <span class="ot">&lt;-</span> <span class="fu">lm</span>(Efficacy <span class="sc">~</span> MatCare <span class="sc">+</span> Esteem, <span class="at">data =</span> sample)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (model_M<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> model_Y<span class="sc">$</span>coef[<span class="dv">3</span>])</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(maternal, indirect_effect, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(boot_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     R original    bootBias   bootSE  bootMed
1 1000 0.053093 -0.00084182 0.020735 0.050879</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% 신뢰구간 계산</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">"bca"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 1000 bootstrap replicates

CALL : 
boot.ci(boot.out = boot_results, type = "bca")

Intervals : 
Level       BCa          
95%   ( 0.0183,  0.1040 )  
Calculations and Intervals on Original Scale</code></pre>
</div>
</div>
</section>
<section id="lavaan-패키지의-활용-sem-분석툴" class="level3">
<h3 class="anchored" data-anchor-id="lavaan-패키지의-활용-sem-분석툴">lavaan 패키지의 활용: SEM 분석툴</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="st">" </span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="st">    # models</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="st">      Esteem ~ a*MatCare</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="st">      Efficacy ~ b*Esteem + c*MatCare</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="st">    # indirect, total effect</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="st">      indirect := a*b</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="st">      total := c + a*b</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="at">model =</span> mod1, <span class="at">data =</span> maternal, <span class="at">se=</span><span class="st">"bootstrap"</span>, <span class="at">bootstrap =</span> <span class="dv">1000</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1, <span class="at">ci=</span>T, <span class="at">fit.measures=</span>F) <span class="co"># ci:confidence interval, fit.measures: fit indices, standardized = F</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                            92

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws             1000
  Number of successful bootstrap draws            1000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
  Esteem ~                                                              
    MatCare    (a)    0.364    0.103    3.527    0.000    0.169    0.577
  Efficacy ~                                                            
    Esteem     (b)    0.146    0.055    2.672    0.008    0.048    0.259
    MatCare    (c)    0.057    0.037    1.529    0.126   -0.017    0.128

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
   .Esteem            0.246    0.045    5.463    0.000    0.159    0.336
   .Efficacy          0.051    0.007    7.180    0.000    0.035    0.063

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
    indirect          0.053    0.022    2.442    0.015    0.015    0.099
    total             0.110    0.034    3.264    0.001    0.047    0.177</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 모든 parameter에 대한 결과</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fit1, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">boot.ci.type=</span><span class="st">"bca.simple"</span>) <span class="co"># bca.simple: bias-corrected, standardized = F</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       lhs op      rhs    label   est    se     z pvalue ci.lower ci.upper
1   Esteem  ~  MatCare        a 0.364 0.103 3.527  0.000    0.169    0.578
2 Efficacy  ~   Esteem        b 0.146 0.055 2.672  0.008    0.042    0.251
3 Efficacy  ~  MatCare        c 0.057 0.037 1.529  0.126   -0.018    0.127
4   Esteem ~~   Esteem          0.246 0.045 5.463  0.000    0.170    0.355
5 Efficacy ~~ Efficacy          0.051 0.007 7.180  0.000    0.039    0.067
6  MatCare ~~  MatCare          0.361 0.000    NA     NA    0.361    0.361
7 indirect :=      a*b indirect 0.053 0.022 2.442  0.015    0.017    0.105
8    total :=    c+a*b    total 0.110 0.034 3.264  0.001    0.048    0.182</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="st">    # direct effect</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="st">      Efficacy ~ c*MatCare</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="st">    # mediator</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="st">      Esteem ~ a*MatCare</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="st">      Efficacy ~ b*Esteem</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="st">    # indirect, total effect</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="st">      indirect := a*b</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="st">      total := c + a*b</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="at">model =</span> mod2, <span class="at">data =</span> maternal, <span class="at">se=</span><span class="st">"bootstrap"</span>, <span class="at">bootstrap =</span> <span class="dv">1000</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2, <span class="at">ci =</span> T, <span class="at">fit.measures =</span> F) <span class="co"># ci:confidence interval, fit.measures: fit indices, standardized = F</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                            92

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws             1000
  Number of successful bootstrap draws             997

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
  Efficacy ~                                                            
    MatCare    (c)    0.057    0.037    1.508    0.131   -0.021    0.133
  Esteem ~                                                              
    MatCare    (a)    0.364    0.100    3.634    0.000    0.179    0.564
  Efficacy ~                                                            
    Esteem     (b)    0.146    0.055    2.659    0.008    0.046    0.259

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
   .Efficacy          0.051    0.007    6.942    0.000    0.035    0.065
   .Esteem            0.246    0.043    5.795    0.000    0.160    0.330

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
    indirect          0.053    0.022    2.397    0.017    0.016    0.103
    total             0.110    0.035    3.142    0.002    0.045    0.181</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 모든 parameter에 대한 결과</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fit2, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">boot.ci.type =</span> <span class="st">"bca.simple"</span>) <span class="co"># bca.simple: bias-corrected, standardized = F</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       lhs op      rhs    label   est    se     z pvalue ci.lower ci.upper
1 Efficacy  ~  MatCare        c 0.057 0.037 1.508  0.131   -0.022    0.132
2   Esteem  ~  MatCare        a 0.364 0.100 3.634  0.000    0.176    0.561
3 Efficacy  ~   Esteem        b 0.146 0.055 2.659  0.008    0.042    0.254
4 Efficacy ~~ Efficacy          0.051 0.007 6.942  0.000    0.039    0.070
5   Esteem ~~   Esteem          0.246 0.043 5.795  0.000    0.179    0.350
6  MatCare ~~  MatCare          0.361 0.000    NA     NA    0.361    0.361
7 indirect :=      a*b indirect 0.053 0.022 2.397  0.017    0.018    0.109
8    total :=    c+a*b    total 0.110 0.035 3.142  0.002    0.044    0.181</code></pre>
</div>
</div>
</section>
</section>
<section id="moderated-mediation에-응용" class="level2">
<h2 class="anchored" data-anchor-id="moderated-mediation에-응용">Moderated Mediation에 응용</h2>
<p><img src="images/moderated-mediation.png" class="img-fluid" width="500"></p>
<div style="line-height: 1.5em; font-size: .9em">
<p>p.&nbsp;424, <em>Introduction to Mediation, Moderation, and Conditional Process Analysis (3e)</em> by Andrew F. Hayes</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>teams <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/hayes2022data/teams/teams.csv"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>teams <span class="ot">&lt;-</span> teams <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">negtone_c =</span> <span class="fu">center</span>(negtone),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">negexp_c =</span> <span class="fu">center</span>(negexp),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">negtone_negexp_c =</span> negtone_c<span class="sc">*</span>negexp_c,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="st">  # models</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="st">    perform ~ c*dysfunc + b1*negtone_c + b2*negexp_c + b3*negtone_negexp_c</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="st">    negtone_c ~ a*dysfunc</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="st">  # conditional effects</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="st">    b_low := b1 + b3*(-0.5437)  # sd = 0.5437</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="st">    b_mean := b1 + b3*0</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="st">    b_high := b1 + b3*0.5437</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="st">  # conditional indirect effects</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="st">    ab_low := a * b_low</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="st">    ab_mean := a * b_mean</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="st">    ab_high := a * b_high</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="st">  # index of moderated mediation</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="st">    index_Mod_Med := a*b3</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(<span class="at">model =</span> mod, <span class="at">data =</span> teams, <span class="at">se=</span><span class="st">"bootstrap"</span>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">ci =</span> T, <span class="at">fit.measures =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 2 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         7

  Number of observations                            60

Model Test User Model:
                                                      
  Test statistic                                 6.999
  Degrees of freedom                                 2
  P-value (Chi-square)                           0.030

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws             1000
  Number of successful bootstrap draws            1000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
  perform ~                                                             
    dysfunc    (c)    0.366    0.184    1.990    0.047   -0.042    0.661
    negtone_c (b1)   -0.431    0.129   -3.345    0.001   -0.645   -0.123
    negexp_c  (b2)   -0.044    0.105   -0.416    0.678   -0.270    0.163
    ngtn_ngx_ (b3)   -0.517    0.243   -2.130    0.033   -1.075   -0.123
  negtone_c ~                                                           
    dysfunc    (a)    0.620    0.227    2.729    0.006    0.211    1.102

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
   .perform           0.185    0.033    5.616    0.000    0.110    0.244
   .negtone_c         0.219    0.051    4.263    0.000    0.122    0.321

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
    b_low            -0.150    0.221   -0.681    0.496   -0.478    0.412
    b_mean           -0.431    0.129   -3.343    0.001   -0.645   -0.123
    b_high           -0.713    0.140   -5.107    0.000   -1.014   -0.452
    ab_low           -0.093    0.153   -0.609    0.543   -0.371    0.289
    ab_mean          -0.267    0.118   -2.262    0.024   -0.522   -0.061
    ab_high          -0.442    0.164   -2.695    0.007   -0.761   -0.142
    index_Mod_Med    -0.320    0.194   -1.648    0.099   -0.820   -0.049</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 모든 parameter에 대한 결과</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fit, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">boot.ci.type =</span> <span class="st">"bca.simple"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                lhs op              rhs         label    est    se      z
1           perform  ~          dysfunc             c  0.366 0.184  1.990
2           perform  ~        negtone_c            b1 -0.431 0.129 -3.345
3           perform  ~         negexp_c            b2 -0.044 0.105 -0.416
4           perform  ~ negtone_negexp_c            b3 -0.517 0.243 -2.130
5         negtone_c  ~          dysfunc             a  0.620 0.227  2.729
6           perform ~~          perform                0.185 0.033  5.616
7         negtone_c ~~        negtone_c                0.219 0.051  4.263
8           dysfunc ~~          dysfunc                0.136 0.000     NA
9           dysfunc ~~         negexp_c               -0.001 0.000     NA
10          dysfunc ~~ negtone_negexp_c               -0.003 0.000     NA
11         negexp_c ~~         negexp_c                0.291 0.000     NA
12         negexp_c ~~ negtone_negexp_c                0.046 0.000     NA
13 negtone_negexp_c ~~ negtone_negexp_c                0.072 0.000     NA
14            b_low :=  b1+b3*(-0.5437)         b_low -0.150 0.221 -0.681
15           b_mean :=          b1+b3*0        b_mean -0.431 0.129 -3.343
16           b_high :=     b1+b3*0.5437        b_high -0.713 0.140 -5.107
17           ab_low :=          a*b_low        ab_low -0.093 0.153 -0.609
18          ab_mean :=         a*b_mean       ab_mean -0.267 0.118 -2.262
19          ab_high :=         a*b_high       ab_high -0.442 0.164 -2.695
20    index_Mod_Med :=             a*b3 index_Mod_Med -0.320 0.194 -1.648
   pvalue ci.lower ci.upper
1   0.047   -0.002    0.707
2   0.001   -0.653   -0.160
3   0.678   -0.252    0.180
4   0.033   -1.087   -0.132
5   0.006    0.208    1.093
6   0.000    0.136    0.279
7   0.000    0.141    0.355
8      NA    0.136    0.136
9      NA   -0.001   -0.001
10     NA   -0.003   -0.003
11     NA    0.291    0.291
12     NA    0.046    0.046
13     NA    0.072    0.072
14  0.496   -0.474    0.428
15  0.001   -0.653   -0.160
16  0.000   -1.089   -0.500
17  0.543   -0.415    0.209
18  0.024   -0.566   -0.088
19  0.007   -0.775   -0.145
20  0.099   -0.880   -0.067</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/r\.modellings\.art");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../contents/diagnostics.html" class="pagination-link" aria-label="Diagnostics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Diagnostics</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This work © 2024 by Sungkyun Cho is licensed under CC BY-NC-SA 4.0</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>